import{_ as Oe,i as v,a as B,x as Re,k as Te,z as De,c as I,w as l,r,o as p,d as t,b as d,g as s,p as C,e as O,h as Me,E as X,n as Y,F as Le,f as Pe,q as J,t as f,J as Be,L as Je,y as Z}from"./index-BOH9GfG6.js";import{R as Ee}from"./RosViewCard-DnLZ-6q6.js";import"./RosLib-C7gnwWt6.js";const Fe={class:"d-flex align-center"},We={key:0,class:"mb-4 mb-sm-6"},qe={class:"d-flex align-center mb-3"},je={class:"d-flex justify-end mt-4 flex-wrap"},Ge={class:"text-center py-4"},He={class:"d-flex align-center mb-2"},Ke={class:"d-flex align-center mb-2"},Qe={class:"d-flex align-center"},Xe={class:"d-flex align-center mb-2"},Ye={class:"d-flex align-center mb-2"},Ze={class:"text-caption text-medium-emphasis mt-1"},et={class:"text-caption text-medium-emphasis mt-4"},tt={class:"d-flex flex-column flex-sm-row"},lt={class:"d-flex align-center"},ot={__name:"AgvMonitoring",setup(at){const R=v(!1),i=v([]),x=v(!1),E=v(null),u=v(2),k=v("16:9"),w=v(640),V=v(!0),ee=[{title:"16:9 (宽屏)",value:"16:9"},{title:"4:3 (标准)",value:"4:3"},{title:"1:1 (正方形)",value:"1:1"},{title:"9:16 (竖屏)",value:"9:16"}],F=o=>{switch(o){case"16:9":return"mdi-television-widescreen";case"4:3":return"mdi-television-classic";case"1:1":return"mdi-crop-square";case"9:16":return"mdi-phone-portrait";default:return"mdi-aspect-ratio"}},te=B(()=>({gridTemplateColumns:`repeat(${u.value}, 1fr)`,gap:R.value?"12px":"16px"})),le=B(()=>({maxWidth:V.value?"auto":`${w.value}px`,width:"100%"})),oe=B(()=>"auto"),c=v({title:"",wsUrl:"",topicName:"",autoStart:!1,presets:[]}),b=v({show:!1,cardIndex:-1,cardTitle:"",cardId:""}),y=v({show:!1,text:"",color:"success"}),W=()=>{x.value=!0,c.value={title:`ROS视频 ${i.value.length+1}`,wsUrl:"",topicName:"",autoStart:!1,presets:[]},Z(()=>{const o=document.querySelector(".card-add-form");o&&o.scrollIntoView({behavior:"smooth",block:"center"}),setTimeout(()=>{const e=document.querySelector(".card-add-form input");e&&e.focus()},300)})},ae=async()=>{const{valid:o}=await E.value.validate();o&&(i.value.push({id:Date.now().toString(),title:c.value.title,wsUrl:c.value.wsUrl,topicName:c.value.topicName,autoStart:c.value.autoStart,presets:[],connectionStatus:"closed"}),x.value=!1,U(`已添加卡片: ${c.value.title}`,"success"),$())},se=()=>{x.value=!1},ne=o=>{o<0||o>=i.value.length||(b.value={show:!0,cardIndex:o,cardTitle:i.value[o].title,cardId:i.value[o].id})},ie=()=>{const{cardIndex:o,cardTitle:e,cardId:n}=b.value;if(o>=0&&o<i.value.length){if(i.value[o].id===n)i.value.splice(o,1);else{const m=i.value.findIndex(z=>z.id===n);m>=0&&i.value.splice(m,1)}U(`已删除卡片: ${e}`,"info"),Z(()=>{$()})}b.value.show=!1},re=o=>{if(o<0||o>=i.value.length)return;const e=i.value[o],n={...JSON.parse(JSON.stringify(e)),id:Date.now().toString(),title:`${e.title} (复制)`};i.value.push(n),U(`已复制卡片: ${e.title}`,"success"),$()},de=(o,e)=>{if(o<0||o>=i.value.length)return;i.value[o].presets||(i.value[o].presets=[]);const n=i.value[o].presets.findIndex(m=>m.id===e.id);n>=0?i.value[o].presets[n]=e:i.value[o].presets.push(e),$()},ue=(o,e)=>{o<0||o>=i.value.length||(i.value[o].connectionStatus=e)},ce=o=>{switch(o){case"connected":return"success";case"connecting":return"warning";case"error":return"error";case"closed":default:return"default"}},me=o=>{switch(o){case"connected":return"mdi-check-circle-outline";case"connecting":return"mdi-progress-clock";case"error":return"mdi-alert-circle-outline";case"closed":default:return"mdi-power-plug-off-outline"}},ve=o=>{switch(o){case"connected":return"已连接";case"connecting":return"连接中";case"error":return"连接错误";case"closed":default:return"未连接"}},pe=o=>{switch(o){case"success":return"mdi-check-circle-outline";case"info":return"mdi-information-outline";case"warning":return"mdi-alert-outline";case"error":return"mdi-alert-circle-outline";default:return"mdi-information-outline"}},U=(o,e="success")=>{y.value={show:!0,text:o,color:e}},fe=()=>{try{localStorage.setItem("ros-viewer-grid-cols",u.value),localStorage.setItem("ros-viewer-aspect-ratio",k.value),localStorage.setItem("ros-viewer-card-max-width",w.value),localStorage.setItem("ros-viewer-fit-content",JSON.stringify(V.value))}catch(o){console.error("保存布局设置失败:",o)}},$=()=>{try{localStorage.setItem("ros-viewer-cards",JSON.stringify(i.value))}catch(o){console.error("保存卡片数据失败:",o),U("保存卡片数据失败","error")}},_e=()=>{try{const o=localStorage.getItem("ros-viewer-cards");o&&(i.value=JSON.parse(o))}catch(o){console.error("加载卡片数据失败:",o),U("加载卡片数据失败","error")}},ge=()=>{try{const o=localStorage.getItem("ros-viewer-grid-cols");o&&(u.value=parseInt(o,10));const e=localStorage.getItem("ros-viewer-aspect-ratio");e&&(k.value=e);const n=localStorage.getItem("ros-viewer-card-max-width");n&&(w.value=parseInt(n,10));const m=localStorage.getItem("ros-viewer-fit-content");m!==null&&(V.value=JSON.parse(m))}catch(o){console.error("加载布局设置失败:",o)}},q=()=>{R.value=window.innerWidth<600||/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)};Re([u,k,w,V],()=>{u.value<1&&(u.value=1),u.value>4&&(u.value=4),fe()});const T=()=>{q();const o=window.innerWidth;o<600?u.value>1&&(u.value=1):o<960&&u.value>2&&(u.value=2)};return Te(()=>{q(),_e(),ge(),window.addEventListener("resize",T),T()}),De(()=>{window.removeEventListener("resize",T)}),(o,e)=>{const n=r("v-icon"),m=r("v-spacer"),z=r("v-slide-x-transition"),_=r("v-btn"),D=r("v-card-title"),we=r("v-divider"),N=r("v-text-field"),g=r("v-col"),j=r("v-switch"),M=r("v-row"),xe=r("v-form"),A=r("v-card"),G=r("v-expand-transition"),be=r("v-alert"),ye=r("v-scale-transition"),H=r("v-tooltip"),L=r("v-chip"),Se=r("v-hover"),Ce=r("v-fade-transition"),P=r("v-card-text"),K=r("v-card-actions"),Q=r("v-slider"),ke=r("v-list-item-title"),Ve=r("v-list-item"),ze=r("v-select"),he=r("v-dialog"),Ie=r("v-snackbar"),Ue=r("v-container");return p(),I(Ue,{fluid:""},{default:l(()=>[t(A,{class:"ros-viewer-container mb-4 card-elevation-transition",variant:"elevated",rounded:"lg",elevation:2},{default:l(()=>[t(D,{class:"d-flex align-center py-3 py-sm-4 px-4 px-sm-6 flex-wrap"},{default:l(()=>[d("div",Fe,[t(n,{class:"mr-3 text-primary",size:"28"},{default:l(()=>e[14]||(e[14]=[s("mdi-video-wireless-outline")])),_:1}),e[15]||(e[15]=d("span",{class:"font-weight-bold text-h6"},"ROS视频查看器",-1))]),t(m),t(_,{color:"primary",variant:"tonal","prepend-icon":"mdi-plus",onClick:W,disabled:x.value,size:"small",rounded:"pill",class:"px-4 font-weight-medium btn-transition mt-2 mt-sm-0"},{default:l(()=>[e[17]||(e[17]=s(" 添加视频卡片 ")),t(z,null,{default:l(()=>[x.value?C("",!0):(p(),I(n,{key:0,class:"ml-1",end:""},{default:l(()=>e[16]||(e[16]=[s("mdi-arrow-down")])),_:1}))]),_:1})]),_:1},8,["disabled"])]),_:1}),t(we),t(P,{class:"pa-3 pa-sm-4"},{default:l(()=>[t(G,null,{default:l(()=>[x.value?(p(),O("div",We,[t(A,{variant:"outlined",class:"pa-3 pa-sm-4 card-add-form",rounded:"lg",border:"start",color:"primary",elevation:"2"},{default:l(()=>[d("div",qe,[t(n,{color:"primary",class:"mr-2"},{default:l(()=>e[18]||(e[18]=[s("mdi-card-plus-outline")])),_:1}),e[19]||(e[19]=d("span",{class:"text-subtitle-1 font-weight-medium"},"添加新视频卡片",-1))]),t(xe,{ref_key:"cardForm",ref:E,onSubmit:Me(ae,["prevent"])},{default:l(()=>[t(M,{dense:""},{default:l(()=>[t(g,{cols:"12",sm:"12",md:"6"},{default:l(()=>[t(N,{modelValue:c.value.title,"onUpdate:modelValue":e[0]||(e[0]=a=>c.value.title=a),label:"卡片标题",variant:"outlined",density:"comfortable",rules:[a=>!!a||"标题不能为空"],"prepend-inner-icon":"mdi-card-text-outline",class:"input-transition"},null,8,["modelValue","rules"])]),_:1}),t(g,{cols:"12",sm:"12",md:"6"},{default:l(()=>[t(N,{modelValue:c.value.wsUrl,"onUpdate:modelValue":e[1]||(e[1]=a=>c.value.wsUrl=a),label:"WebSocket URL",variant:"outlined",density:"comfortable",hint:"例如: ws://localhost:9090","persistent-hint":"","prepend-inner-icon":"mdi-web",class:"input-transition"},null,8,["modelValue"])]),_:1}),t(g,{cols:"12",sm:"12",md:"6"},{default:l(()=>[t(N,{modelValue:c.value.topicName,"onUpdate:modelValue":e[2]||(e[2]=a=>c.value.topicName=a),label:"Topic 名称",variant:"outlined",density:"comfortable",hint:"例如: /camera/image_raw/compressed","persistent-hint":"","prepend-inner-icon":"mdi-message-text-outline",class:"input-transition"},null,8,["modelValue"])]),_:1}),t(g,{cols:"12",sm:"12",md:"6"},{default:l(()=>[t(j,{modelValue:c.value.autoStart,"onUpdate:modelValue":e[3]||(e[3]=a=>c.value.autoStart=a),label:"自动连接",color:"primary","hide-details":"",density:"comfortable","prepend-icon":"mdi-connection",inset:""},null,8,["modelValue"])]),_:1})]),_:1}),d("div",je,[t(z,null,{default:l(()=>[t(_,{variant:"outlined",onClick:se,class:"mr-2 mb-2 mb-sm-0 px-4",rounded:"pill",size:"small","prepend-icon":"mdi-close"},{default:l(()=>e[20]||(e[20]=[s(" 取消 ")])),_:1})]),_:1}),t(_,{color:"primary",variant:"elevated",type:"submit",class:"px-5",rounded:"pill",size:"small","prepend-icon":"mdi-check",elevation:3},{default:l(()=>e[21]||(e[21]=[s(" 确认添加 ")])),_:1})])]),_:1},512)]),_:1})])):C("",!0)]),_:1}),t(ye,null,{default:l(()=>[i.value.length===0&&!x.value?(p(),I(M,{key:0,class:"mt-2"},{default:l(()=>[t(g,null,{default:l(()=>[t(be,{type:"info",variant:"tonal",border:"start",class:"empty-state-alert pa-4 pa-sm-6",icon:"mdi-video-off-outline"},{default:l(()=>[d("div",Ge,[t(n,{size:"48",class:"mb-4 empty-icon"},{default:l(()=>e[22]||(e[22]=[s("mdi-video-off-outline")])),_:1}),e[24]||(e[24]=d("div",{class:"text-subtitle-1 mb-2"},"暂无视频卡片",-1)),e[25]||(e[25]=d("div",{class:"text-body-2 text-medium-emphasis"},' 点击上方"添加视频卡片"按钮开始创建 ',-1)),t(_,{color:"primary",class:"mt-4",variant:"tonal",rounded:"pill","prepend-icon":"mdi-plus",onClick:W,size:"small"},{default:l(()=>e[23]||(e[23]=[s(" 添加第一个视频卡片 ")])),_:1})])]),_:1})]),_:1})]),_:1})):C("",!0)]),_:1}),t(Ce,null,{default:l(()=>[i.value.length>0?(p(),O("div",{key:0,class:Y(["cards-container",`grid-cols-${u.value}`]),style:X(te.value)},[(p(!0),O(Le,null,Pe(i.value,(a,h)=>(p(),O("div",{key:a.id,class:"card-wrapper",style:X(le.value)},[t(Se,null,{default:l(({isHovering:Ne,props:$e})=>[d("div",J({ref_for:!0},$e,{class:"h-100"}),[t(Ee,{title:a.title,"ws-url":a.wsUrl,"topic-name":a.topicName,"auto-start":a.autoStart,"saved-presets":a.presets||[],height:oe.value,"aspect-ratio":k.value,onPresetSave:S=>de(h,S),onConnectionChange:S=>ue(h,S),class:"video-card"},null,8,["title","ws-url","topic-name","auto-start","saved-presets","height","aspect-ratio","onPresetSave","onConnectionChange"]),d("div",{class:Y(["card-actions elevation-4",{"card-actions-visible":Ne||R.value}])},[t(H,{location:"top",text:"删除卡片"},{activator:l(({props:S})=>[t(_,J({ref_for:!0},S,{icon:"mdi-delete-outline",color:"error",variant:"text",size:"small",onClick:Ae=>ne(h),class:"card-action-btn"}),null,16,["onClick"])]),_:2},1024),t(H,{location:"top",text:"复制配置"},{activator:l(({props:S})=>[t(_,J({ref_for:!0},S,{icon:"mdi-content-copy",color:"primary",variant:"text",size:"small",onClick:Ae=>re(h),class:"card-action-btn"}),null,16,["onClick"])]),_:2},1024)],2),t(L,{color:ce(a.connectionStatus),size:"small",class:"connection-status-chip",variant:"elevated"},{default:l(()=>[t(n,{start:"",size:"small"},{default:l(()=>[s(f(me(a.connectionStatus)),1)]),_:2},1024),s(" "+f(ve(a.connectionStatus)),1)]),_:2},1032,["color"])],16)]),_:2},1024)],4))),128))],6)):C("",!0)]),_:1})]),_:1}),t(G,null,{default:l(()=>[i.value.length>0?(p(),I(K,{key:0,class:"px-4 pb-4"},{default:l(()=>[t(m),t(L,{variant:"tonal",color:"primary",size:"small",class:"font-weight-medium","prepend-icon":"mdi-information-outline"},{default:l(()=>[s(" 共 "+f(i.value.length)+" 个视频卡片 ",1)]),_:1})]),_:1})):C("",!0)]),_:1})]),_:1}),t(A,{class:"mb-4 card-elevation-transition",variant:"elevated",rounded:"lg",elevation:1},{default:l(()=>[t(D,{class:"py-3 py-sm-4 px-4 px-sm-6 d-flex align-center"},{default:l(()=>[t(n,{class:"mr-3 text-primary",size:"24"},{default:l(()=>e[26]||(e[26]=[s("mdi-view-grid-outline")])),_:1}),e[27]||(e[27]=d("span",{class:"font-weight-bold"},"布局设置",-1))]),_:1}),t(P,{class:"px-4 px-sm-6 pb-4 pb-sm-6"},{default:l(()=>[t(M,null,{default:l(()=>[t(g,{cols:"12",md:"6"},{default:l(()=>[d("div",He,[t(n,{class:"mr-2 text-medium-emphasis"},{default:l(()=>e[28]||(e[28]=[s("mdi-view-grid-plus-outline")])),_:1}),e[29]||(e[29]=d("span",{class:"text-subtitle-2"},"每行卡片数量",-1))]),t(Q,{modelValue:u.value,"onUpdate:modelValue":e[5]||(e[5]=a=>u.value=a),min:1,max:4,step:1,"thumb-label":"always",label:"调整每行显示的卡片数量","show-ticks":"always","tick-labels":["1","2","3","4"],color:"primary","track-color":"primary-lighten-3",class:"mt-2 mt-sm-4 slider-transition","hide-details":"auto"},{append:l(()=>[t(z,null,{default:l(()=>[o.$vuetify.display.smAndDown?C("",!0):(p(),I(N,{key:0,modelValue:u.value,"onUpdate:modelValue":e[4]||(e[4]=a=>u.value=a),type:"number",style:{width:"70px"},density:"compact",variant:"outlined",min:1,max:4,class:"ml-2 ml-sm-4 input-transition","hide-details":""},null,8,["modelValue"]))]),_:1})]),prepend:l(()=>[t(n,{class:"d-none d-sm-flex"},{default:l(()=>e[30]||(e[30]=[s("mdi-view-sequential-outline")])),_:1})]),"append-inner":l(()=>[t(n,{class:"d-none d-sm-flex"},{default:l(()=>e[31]||(e[31]=[s("mdi-view-grid-outline")])),_:1})]),_:1},8,["modelValue"])]),_:1}),t(g,{cols:"12",md:"6"},{default:l(()=>[d("div",Ke,[t(n,{class:"mr-2 text-medium-emphasis"},{default:l(()=>e[32]||(e[32]=[s("mdi-aspect-ratio")])),_:1}),e[33]||(e[33]=d("span",{class:"text-subtitle-2"},"视频宽高比",-1))]),t(ze,{modelValue:k.value,"onUpdate:modelValue":e[6]||(e[6]=a=>k.value=a),items:ee,label:"选择视频显示比例",density:"comfortable",variant:"outlined","prepend-inner-icon":"mdi-television",class:"input-transition"},{selection:l(({item:a})=>[d("div",Qe,[t(n,{class:"mr-2",size:"small"},{default:l(()=>[s(f(F(a.value)),1)]),_:2},1024),s(" "+f(a.title),1)])]),item:l(({item:a,props:h})=>[t(Ve,Be(Je(h)),{prepend:l(()=>[t(n,null,{default:l(()=>[s(f(F(a.value)),1)]),_:2},1024)]),default:l(()=>[t(ke,null,{default:l(()=>[s(f(a.title),1)]),_:2},1024)]),_:2},1040)]),_:1},8,["modelValue"])]),_:1}),t(g,{cols:"12",md:"6"},{default:l(()=>[d("div",Xe,[t(n,{class:"mr-2 text-medium-emphasis"},{default:l(()=>e[34]||(e[34]=[s("mdi-resize")])),_:1}),e[35]||(e[35]=d("span",{class:"text-subtitle-2"},"卡片最大宽度",-1))]),t(Q,{modelValue:w.value,"onUpdate:modelValue":e[8]||(e[8]=a=>w.value=a),min:300,max:1200,step:50,"thumb-label":"always",label:"调整卡片的最大宽度 (像素)",color:"primary","track-color":"primary-lighten-3",class:"mt-2 mt-sm-4 slider-transition","hide-details":"auto"},{"thumb-label":l(({modelValue:a})=>[s(f(a)+"px ",1)]),append:l(()=>[t(z,null,{default:l(()=>[o.$vuetify.display.smAndDown?C("",!0):(p(),I(N,{key:0,modelValue:w.value,"onUpdate:modelValue":e[7]||(e[7]=a=>w.value=a),type:"number",style:{width:"90px"},density:"compact",variant:"outlined",min:300,max:1200,step:50,suffix:"px",class:"ml-2 ml-sm-4 input-transition","hide-details":""},null,8,["modelValue"]))]),_:1})]),prepend:l(()=>[t(n,{class:"d-none d-sm-flex"},{default:l(()=>e[36]||(e[36]=[s("mdi-arrow-collapse")])),_:1})]),"append-inner":l(()=>[t(n,{class:"d-none d-sm-flex"},{default:l(()=>e[37]||(e[37]=[s("mdi-arrow-expand")])),_:1})]),_:1},8,["modelValue"])]),_:1}),t(g,{cols:"12",md:"6"},{default:l(()=>[d("div",Ye,[t(n,{class:"mr-2 text-medium-emphasis"},{default:l(()=>e[38]||(e[38]=[s("mdi-fit-to-screen-outline")])),_:1}),e[39]||(e[39]=d("span",{class:"text-subtitle-2"},"自适应内容",-1))]),t(j,{modelValue:V.value,"onUpdate:modelValue":e[9]||(e[9]=a=>V.value=a),label:"自适应内容大小",color:"primary",density:"comfortable",hint:"开启后会根据内容自动调整视频大小","persistent-hint":"","prepend-icon":"mdi-responsive",inset:"",class:"mt-3"},{message:l(()=>[d("div",Ze,[t(n,{size:"14",start:""},{default:l(()=>e[40]||(e[40]=[s("mdi-information-outline")])),_:1}),e[41]||(e[41]=s(" 开启后将优先考虑内容显示，忽略最大宽度限制 "))])]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1}),t(he,{modelValue:b.value.show,"onUpdate:modelValue":e[11]||(e[11]=a=>b.value.show=a),"max-width":"400",transition:"dialog-bottom-transition"},{default:l(()=>[t(A,{rounded:"lg",class:"dialog-card"},{default:l(()=>[t(D,{class:"d-flex align-center pt-5 pb-2 px-4 px-sm-6"},{default:l(()=>[t(n,{color:"error",class:"mr-3",size:"24"},{default:l(()=>e[42]||(e[42]=[s("mdi-delete-alert")])),_:1}),e[43]||(e[43]=d("span",{class:"text-h6 font-weight-medium"},"确认删除",-1))]),_:1}),t(P,{class:"px-4 px-sm-6 pb-2 pt-3"},{default:l(()=>[e[47]||(e[47]=d("p",{class:"text-body-1 mb-2"},"您确定要删除以下视频卡片吗？",-1)),t(L,{color:"primary",variant:"outlined",class:"mt-2 font-weight-medium",size:"large"},{default:l(()=>[t(n,{start:""},{default:l(()=>e[44]||(e[44]=[s("mdi-card-outline")])),_:1}),s(" "+f(b.value.cardTitle),1)]),_:1}),d("div",et,[t(n,{size:"16",color:"warning",class:"mr-1"},{default:l(()=>e[45]||(e[45]=[s("mdi-alert-circle-outline")])),_:1}),e[46]||(e[46]=s(" 此操作无法撤销 "))])]),_:1}),t(K,{class:"pa-4 pa-sm-6"},{default:l(()=>[t(m),d("div",tt,[t(_,{variant:"tonal",onClick:e[10]||(e[10]=a=>b.value.show=!1),class:"mb-2 mb-sm-0 mr-0 mr-sm-3 px-5",rounded:"pill","prepend-icon":"mdi-close"},{default:l(()=>e[48]||(e[48]=[s(" 取消 ")])),_:1}),t(_,{color:"error",variant:"elevated",onClick:ie,rounded:"pill",class:"px-5","prepend-icon":"mdi-delete-outline"},{default:l(()=>e[49]||(e[49]=[s(" 删除 ")])),_:1})])]),_:1})]),_:1})]),_:1},8,["modelValue"]),t(Ie,{modelValue:y.value.show,"onUpdate:modelValue":e[13]||(e[13]=a=>y.value.show=a),color:y.value.color,timeout:"3000",location:"top",rounded:"pill",class:"snackbar-transition"},{actions:l(()=>[t(_,{icon:"mdi-close",variant:"text",onClick:e[12]||(e[12]=a=>y.value.show=!1)})]),default:l(()=>[d("div",lt,[t(n,{class:"mr-2",icon:pe(y.value.color)},null,8,["icon"]),s(" "+f(y.value.text),1)])]),_:1},8,["modelValue","color"])]),_:1})}}},rt=Oe(ot,[["__scopeId","data-v-29796d64"]]);export{rt as default};
