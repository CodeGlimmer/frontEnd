import{_ as I,i as C,k as z,P as A,C as F,e as c,o as n,A as K,b as _,F as L,f as B,h as b,n as g,t as k,s as V,d as S,l as D,c as x,w,r as y,g as N}from"./index-BOH9GfG6.js";import{u as E}from"./theme-HQ1WYIhm.js";import"./useSocket-CGAbKkod.js";import{R as T}from"./RosLib-C7gnwWt6.js";class O{constructor({linear:o,angular:r,rosUrl:a}){this.linear=o,this.angular=r,this.keyState=[!1,!1,!1,!1],this.ros=new T.Ros({url:a}),this.cmdVel=new T.Topic({ros:this.ros,name:"/cmd_vel",messageType:"geometry_msgs/Twist"}),this.timer=setInterval(this.sendMessage.bind(this),100)}sendMessage(){const o=(-this.keyState[1]+this.keyState[3])*this.linear,r=(this.keyState[0]-this.keyState[2])*this.angular,a=new T.Message({linear:{x:o,y:0,z:0},angular:{x:0,y:0,z:r}});this.cmdVel.publish(a)}updateKeyState(o){console.log(o),this.keyState=o}dispose(){clearInterval(this.timer)}}const R={class:"keyboard tw:hover:-translate-y-1.5 tw:hover:scale-[1.01] elevation-12 tw:hover:!shadow-m-elevation-24 tw:!w-full"},W={class:"key-row tw:!w-full"},P=["onMousedown","onMouseup","onTouchstart","onTouchend"],U={class:"key-row tw:!w-full"},q=["onMousedown","onMouseup","onTouchstart","onTouchend"],j={__name:"KeyBoard",props:{darkMode:{type:Boolean,default:!0}},emits:["key-state-change"],setup(p,{emit:o}){const r=o,a=C([{id:"w",label:"W"},{id:"a",label:"A"},{id:"s",label:"S"},{id:"d",label:"D"}]),l=C([]);let i=null;const f=()=>{const s=["a","s","d","w"].map(m=>l.value.includes(m));r("key-state-change",s)},d=e=>{l.value.includes(e)||(l.value.push(e),M(e),f())},u=e=>{l.value=l.value.filter(s=>s!==e),$(),f()},M=e=>{i=setInterval(()=>{console.log(`Long press ${e}`)},100)},$=()=>{i&&(clearInterval(i),i=null)},h=e=>{const s=e.key.toLowerCase();["w","a","s","d"].includes(s)&&(e.preventDefault(),e.type==="keydown"?d(s):u(s))};return z(()=>{window.addEventListener("keydown",h),window.addEventListener("keyup",h)}),A(()=>{window.removeEventListener("keydown",h),window.removeEventListener("keyup",h)}),(e,s)=>{const m=F("ripple");return n(),c("div",{class:g(["keyboard-container",{"dark-mode":p.darkMode}])},[K((n(),c("div",R,[_("div",W,[(n(!0),c(L,null,B(a.value.slice(0,1),t=>(n(),c("div",{key:t.id,class:g(["key tw:!aspect-square tw:!size-1/4",{active:l.value.includes(t.id)}]),onMousedown:v=>d(t.id),onMouseup:v=>u(t.id),onTouchstart:b(v=>d(t.id),["prevent"]),onTouchend:b(v=>u(t.id),["prevent"])},[_("span",null,k(t.label),1)],42,P))),128))]),_("div",U,[(n(!0),c(L,null,B(a.value.slice(1,4),t=>(n(),c("div",{key:t.id,class:g(["key tw:!aspect-square tw:!size-1/4",{active:l.value.includes(t.id)}]),onMousedown:v=>d(t.id),onMouseup:v=>u(t.id),onTouchstart:b(v=>d(t.id),["prevent"]),onTouchend:b(v=>u(t.id),["prevent"])},[_("span",null,k(t.label),1)],42,q))),128))])])),[[m,void 0,void 0,{center:!0}]])],2)}}},G=I(j,[["__scopeId","data-v-6232bb99"]]),se={__name:"SendingOperations",props:{linear:{type:Number,default:5},angular:{type:Number,default:.2}},setup(p){const o=E(),{isDarkMode:r}=V(o);let a;const l=i=>{a.updateKeyState(i)};return z(()=>{a=new O({linear:p.linear,angular:p.angular,rosUrl:"ws://0.0.0.0:9091"})}),A(()=>{a.dispose()}),(i,f)=>(n(),c("div",null,[S(G,{"dark-mode":D(r),onKeyStateChange:l},null,8,["dark-mode"])]))}},H={class:"status-card__title font-weight-medium"},J={class:"status-card__content d-flex align-center"},Q={class:"status-card__value text-body-1 font-weight-medium ml-2"},X={__name:"WorkingStatus",setup(p){const o=E(),{isDarkMode:r}=V(o),a=C([{title:"AGV Status",value:"充电中",icon:"mdi-robot",iconColor:"#4CAF50",type:"agv"},{title:"电池状态",value:"10%",icon:"mdi-battery-charging-10",iconColor:"#FF5252",type:"battery"},{title:"区域位置",value:"工训楼",icon:"mdi-factory",iconColor:"#2196F3",type:"location"}]);return(l,i)=>{const f=y("v-icon"),d=y("v-card"),u=y("v-col"),M=y("v-row"),$=y("v-container"),h=y("v-sheet"),e=F("ripple");return K((n(),x(h,{class:g(["status-dashboard rounded-xl ma-3 pa-4 overflow-hidden",{"dark-mode":D(r)}]),elevation:"12"},{default:w(()=>[S($,{fluid:"",class:"px-0"},{default:w(()=>[S(M,{class:"status-cards"},{default:w(()=>[(n(!0),c(L,null,B(a.value,(s,m)=>(n(),x(u,{key:m,cols:"12",sm:"6",md:"4",lg:"4",class:"status-col"},{default:w(()=>[K((n(),x(d,{class:g(["status-card d-flex align-center justify-space-between",`status-card--${s.type}`,{"dark-card":D(r)}]),rounded:"lg",elevation:"6"},{default:w(()=>[_("div",H,k(s.title),1),_("div",J,[S(f,{size:"24",color:s.iconColor,class:"status-card__icon"},{default:w(()=>[N(k(s.icon),1)]),_:2},1032,["color"]),_("span",Q,k(s.value),1)])]),_:2},1032,["class"])),[[e]])]),_:2},1024))),128))]),_:1})]),_:1})]),_:1},8,["class"])),[[e]])}}},oe=I(X,[["__scopeId","data-v-0f3344b7"]]);export{oe as W,se as _};
