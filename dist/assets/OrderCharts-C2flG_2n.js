import{_ as Wt,H as Lt,c as Z,w as n,i as C,a as W,x as ft,k as Ft,r as _,o as M,d as t,g as w,t as P,e as mt,F as yt,f as ht,b as D,D as jt,p as Bt}from"./index-BOH9GfG6.js";import{u as Rt}from"./order-DAGz9zc-.js";import{i as L}from"./index-DkaH_rt3.js";import"./OderManagement-Dzc_ZI8N.js";import"./useSocket-CGAbKkod.js";import"./RosLib-C7gnwWt6.js";const Nt=Lt({name:"OrderAnalyticsDashboard",setup(){const d=Rt(),i=C(null),at=C(null),rt=C(null),st=C(null),lt=C(null),z=C(null),A=C(null),k=C(!1),H=C(""),T=C("month"),V=C("产品类型与订单量相关性"),x=C(!1),S=C(!1),E=C(10);let U=null,I=null,F=null,K=null,j=null,B=null,R=null;const Y=C({productTypes:[],priorityRange:[1,10],quantityRange:[0,100]}),it=C([{title:"订单号",key:"order_id",sortable:!0},{title:"产品类型",key:"product_type",sortable:!0},{title:"数量",key:"order_quantity",sortable:!0},{title:"日期",key:"order_date",sortable:!0},{title:"优先级",key:"priority",sortable:!0}]),J=W(()=>d.show_list),dt=W(()=>{const o=new Set;return d.show_list.forEach(a=>{o.add(a.product_type)}),Array.from(o)}),ut=W(()=>new Date().toLocaleString("zh-CN")),X=W(()=>{const o=d.show_list;if(!o.length)return[];const a=o.length,f=o.reduce((c,r)=>c+parseInt(r.order_quantity),0),p=o.reduce((c,r)=>c+parseInt(r.priority),0)/a,u=o.filter(c=>parseInt(c.priority)>=8).length;return[{title:"总订单数",value:a,icon:"mdi-clipboard-list",color:"bg-blue-lighten-5"},{title:"总订单量",value:f,icon:"mdi-package-variant",color:"bg-green-lighten-5"},{title:"平均优先级",value:p.toFixed(1),icon:"mdi-alert-circle",color:"bg-orange-lighten-5"},{title:"高优先级订单",value:u,icon:"mdi-flag",color:"bg-red-lighten-5"}]}),tt=W(()=>["产品类型与订单量相关性","优先级与日期分布","订单量分布热力图","订单组合分析"]),et=W(()=>{const o=d.show_list;if(!o.length)return[];const a={};o.forEach(l=>{a[l.product_type]=(a[l.product_type]||0)+1});let f="",p=0;Object.entries(a).forEach(([l,s])=>{s>p&&(p=s,f=l)});const u={};o.forEach(l=>{const s=l.order_date.substring(5,7);u[s]||(u[s]={total:0,count:0}),u[s].total+=parseInt(l.priority),u[s].count+=1});let c=!0,r=0;Object.values(u).forEach(({total:l,count:s},g)=>{const h=l/s;g>0&&h<r&&(c=!1),r=h});const e={};o.forEach(l=>{const s=l.order_date.substring(5,7);e[s]||(e[s]=0),e[s]+=parseInt(l.order_quantity)});const m=Object.keys(e).sort(),b=m.length>=2&&e[m[m.length-1]]>e[m[0]];return[{title:`最受欢迎的产品类型是 ${f}`,description:`占总订单的 ${(p/o.length*100).toFixed(1)}%`,icon:"mdi-trophy",color:"amber"},{title:`订单优先级趋势${c?"上升":"下降"}`,description:`整体优先级${c?"逐月增加，需加强资源投入":"逐月下降，压力有所缓解"}`,icon:c?"mdi-trending-up":"mdi-trending-down",color:c?"red":"green"},{title:`订单量${b?"呈增长趋势":"呈下降趋势"}`,description:b?"整体订单量增长，显示业务扩张":"整体订单量下降，需要关注销售情况",icon:b?"mdi-chart-line-variant":"mdi-chart-line-variant-decrease",color:b?"blue":"deep-orange"}]}),ot=W(()=>{const o=d.show_list;if(!o.length)return[];const a=[],f=o.map(c=>parseInt(c.order_quantity)),p=f.reduce((c,r)=>c+r,0)/f.length,u=Math.sqrt(f.reduce((c,r)=>c+Math.pow(r-p,2),0)/f.length);return o.forEach(c=>{const r=parseInt(c.order_quantity);Math.abs(r-p)>3*u&&a.push({order_id:c.order_id,description:`订单量异常${r>p?"高":"低"} (${r})`});const e=parseInt(c.priority);e>=9&&r<p/2&&a.push({order_id:c.order_id,description:`高优先级(${e})但低订单量(${r})`})}),a}),ct=()=>{U=L(i.value),I=L(at.value),F=L(rt.value),K=L(st.value),j=L(lt.value),nt(),window.addEventListener("resize",()=>{U.resize(),I.resize(),F.resize(),K.resize(),j.resize(),B&&B.resize(),R&&R.resize()})},nt=()=>{d.show_list.length&&(y(),Q(),xt(),St(),gt())},y=()=>{const o=d.show_list;let a,f;T.value==="week"?(a=l=>{const s=new Date(l),g=new Date(s),h=s.getDay()||7;g.setDate(s.getDate()-h+1);const v=new Date(g);v.setDate(g.getDate()+6);const O=g.toISOString().substring(5,10).replace("-","/"),q=v.toISOString().substring(5,10).replace("-","/");return`${O}-${q}`},f=l=>{const s=new Date(l),g=new Date(s.getFullYear(),0,1),h=g.getDay(),v=Math.floor((s-g)/(24*60*60*1e3))+1,O=Math.ceil((v+h-1)/7);return`${s.getFullYear()}-${O}`}):T.value==="month"?(a=l=>l.substring(5,7)+"月",f=l=>l.substring(5,7)):(a=l=>l.substring(0,4)+"年",f=l=>l.substring(0,4));const p={},u={},c={};o.forEach(l=>{const s=f(l.order_date);p[s]||(p[s]=0,u[s]=0,c[s]={}),p[s]++,u[s]+=parseInt(l.order_quantity);const g=l.product_type;c[s][g]=(c[s][g]||0)+1});const r=new Set;o.forEach(l=>r.add(l.product_type));const e=Object.keys(p).sort((l,s)=>{if(T.value==="week"){const[g,h]=l.split("-").map(Number),[v,O]=s.split("-").map(Number);return g!==v?g-v:h-O}else return l-s}),m=[{name:"订单数",type:"line",smooth:!0,lineStyle:{width:3},symbolSize:8,data:e.map(l=>p[l]),z:3},{name:"订单量",type:"line",smooth:!0,lineStyle:{width:3,type:"dashed"},symbolSize:8,yAxisIndex:1,data:e.map(l=>u[l]),z:2}];Array.from(r).forEach(l=>{m.push({name:`类型 ${l}`,type:"bar",stack:"产品类型",emphasis:{focus:"series"},data:e.map(s=>c[s][l]||0),z:1})});const b={title:{text:"订单趋势分析",left:"center",textStyle:{fontWeight:"normal",fontSize:16}},tooltip:{trigger:"axis",axisPointer:{type:"cross",label:{backgroundColor:"#6a7985"}}},legend:{data:["订单数","订单量",...Array.from(r).map(l=>`类型 ${l}`)],bottom:"0%",type:"scroll"},toolbox:{feature:{saveAsImage:{},dataZoom:{},restore:{}}},grid:{left:"3%",right:"4%",bottom:"15%",top:"15%",containLabel:!0},xAxis:{type:"category",boundaryGap:!0,data:e.map(l=>{if(T.value==="week"){const[s,g]=l.split("-"),h=new Date(parseInt(s),0,1);return h.setDate(h.getDate()+(g-1)*7-h.getDay()+1),a(h.toISOString().substring(0,10))}else return a(l)})},yAxis:[{type:"value",name:"订单数",position:"left"},{type:"value",name:"订单量",position:"right"}],series:m,color:["#3f51b5","#4caf50","#f44336","#ff9800","#9c27b0","#00bcd4","#ffeb3b","#795548","#607d8b","#e91e63"]};U.setOption(b)},Q=()=>{const o=d.show_list,a={};o.forEach(u=>{const c=u.product_type;a[c]||(a[c]={count:0,quantity:0}),a[c].count++,a[c].quantity+=parseInt(u.order_quantity)});const f=Object.keys(a).sort(),p={title:{text:"产品类型分布",left:"center",textStyle:{fontWeight:"normal",fontSize:16}},tooltip:{trigger:"item",formatter:"{b}: {c} ({d}%)"},legend:{orient:"vertical",left:10,top:"middle",type:"scroll",formatter:u=>{const c=(a[u].count/o.length*100).toFixed(1);return`${u} (${c}%)`}},series:[{name:"产品类型",type:"pie",radius:["40%","70%"],center:["60%","50%"],avoidLabelOverlap:!1,itemStyle:{borderRadius:10,borderColor:"#fff",borderWidth:2},label:{show:!1,position:"center"},emphasis:{label:{show:!0,fontSize:"14",fontWeight:"bold"}},labelLine:{show:!1},data:f.map(u=>({name:u,value:a[u].count}))}],color:["#f44336","#e91e63","#9c27b0","#673ab7","#3f51b5","#2196f3","#03a9f4","#00bcd4","#009688","#4caf50"]};I.setOption(p)},xt=()=>{const o=d.show_list,a={};for(let p=1;p<=10;p++)a[p]=0;o.forEach(p=>{const u=parseInt(p.priority);a[u]++});const f={title:{text:"订单优先级分布",left:"center",textStyle:{fontWeight:"normal",fontSize:16}},tooltip:{trigger:"axis",axisPointer:{type:"shadow"}},grid:{left:"3%",right:"4%",bottom:"3%",top:"15%",containLabel:!0},xAxis:{type:"category",data:Object.keys(a),axisTick:{alignWithLabel:!0},name:"优先级"},yAxis:{type:"value",name:"订单数"},visualMap:{orient:"horizontal",left:"center",bottom:0,min:1,max:10,text:["高优先级","低优先级"],dimension:0,inRange:{color:["#4caf50","#ffeb3b","#f44336"]},show:!1},series:[{name:"订单数",type:"bar",barWidth:"60%",data:Object.entries(a).map(([p,u])=>({value:u,itemStyle:{color:vt(p)}}))}]};F.setOption(f)},St=()=>{const o=d.show_list,a=o.map(r=>[parseInt(r.order_quantity),parseInt(r.priority),r.product_type,r.order_id]),f=o.map(r=>parseInt(r.order_quantity)),p=Math.min(...f),u=Math.max(...f),c={title:{text:"订单量与优先级关系",left:"center",textStyle:{fontWeight:"normal",fontSize:16}},tooltip:{trigger:"item",formatter:function(r){const e=r.data;return`订单号: ${e[3]}<br/>产品类型: ${e[2]}<br/>订单量: ${e[0]}<br/>优先级: ${e[1]}`}},grid:{left:"3%",right:"4%",bottom:"10%",top:"15%",containLabel:!0},xAxis:{type:"value",name:"订单量",min:p,max:u},yAxis:{type:"value",name:"优先级",min:1,max:10},toolbox:{feature:{dataZoom:{},restore:{}}},series:[{type:"scatter",symbolSize:function(r){return Math.sqrt(r[0])*1.5+5},itemStyle:{color:function(r){return pt(r.data[2])},opacity:.8},emphasis:{focus:"series",itemStyle:{opacity:1}},data:a}]};K.setOption(c)},gt=()=>{const o=d.show_list;if(!o.length)return;let a={};switch(V.value){case"产品类型与订单量相关性":a=bt(o);break;case"优先级与日期分布":a=Ct(o);break;case"订单量分布热力图":a=kt(o);break;case"订单组合分析":a=It(o);break;default:a=bt(o)}j.setOption(a)},bt=o=>{const a={};o.forEach(e=>{const m=e.product_type;a[m]||(a[m]={orders:0,totalQuantity:0,totalPriority:0,quantities:[]}),a[m].orders++;const b=parseInt(e.order_quantity),l=parseInt(e.priority);a[m].totalQuantity+=b,a[m].totalPriority+=l,a[m].quantities.push(b)});const f=Object.keys(a).sort(),p=f.map(e=>a[e].totalQuantity/a[e].orders),u=f.map(e=>a[e].totalPriority/a[e].orders),c=f.map(e=>a[e].orders),r=f.map(e=>{const m=a[e].totalQuantity/a[e].orders,b=a[e].quantities,l=b.reduce((s,g)=>s+Math.pow(g-m,2),0)/b.length;return Math.sqrt(l)});return{title:{text:"产品类型分析",left:"center",textStyle:{fontWeight:"normal",fontSize:16}},tooltip:{trigger:"axis",axisPointer:{type:"cross"},formatter:function(e){let m=`${e[0].axisValue}<br/>`;return e.forEach(b=>{const l=`<span style="display:inline-block;margin-right:5px;border-radius:10px;width:10px;height:10px;background-color:${b.color};"></span>`;m+=`${l}${b.seriesName}: ${b.value.toFixed(2)}<br/>`}),m+=`<span style="display:inline-block;margin-right:5px;border-radius:10px;width:10px;height:10px;background-color:#ff9800;"></span>订单数: ${c[e[0].dataIndex]}<br/>`,m}},toolbox:{feature:{saveAsImage:{},dataView:{readOnly:!0}}},legend:{data:["平均订单量","平均优先级","订单量标准差"],bottom:"0%"},grid:{left:"3%",right:"4%",bottom:"10%",top:"15%",containLabel:!0},xAxis:{type:"category",name:"产品类型",data:f,axisPointer:{type:"shadow"}},yAxis:[{type:"value",name:"平均订单量",position:"left"},{type:"value",name:"平均优先级",min:1,max:10,position:"right",axisLine:{lineStyle:{color:"#ff5722"}}}],series:[{name:"平均订单量",type:"bar",data:p},{name:"平均优先级",type:"line",yAxisIndex:1,lineStyle:{width:3},symbolSize:8,data:u},{name:"订单量标准差",type:"line",lineStyle:{width:3,type:"dashed"},symbolSize:8,data:r},{name:"订单数",type:"bar",stack:"订单",emphasis:{focus:"series"},data:c,z:-1,opacity:.3,tooltip:{show:!1}}],color:["#3f51b5","#ff5722","#4caf50","#ff9800"]}},Ct=o=>{const a={};o.forEach(p=>{const u=p.order_date,c=u.substring(5,7),r=u.substring(8,10),e=`${c}-${r}`;a[e]||(a[e]={count:0,totalPriority:0,totalQuantity:0}),a[e].count++,a[e].totalPriority+=parseInt(p.priority),a[e].totalQuantity+=parseInt(p.order_quantity)});const f=Object.entries(a).map(([p,u])=>{const[c,r]=p.split("-");return[`2025-${c}-${r}`,u.totalPriority/u.count]});return{title:{text:"订单优先级日历分布",left:"center",textStyle:{fontWeight:"normal",fontSize:16}},tooltip:{formatter:function(p){const u=p.value[0],c=p.value[1],r=u.substring(5);return`${u}<br/>平均优先级: ${c.toFixed(2)}<br/>订单数: ${a[r]?.count||0}`}},visualMap:{min:1,max:10,calculable:!0,orient:"horizontal",left:"center",bottom:20,inRange:{color:["#4caf50","#ffeb3b","#ff9800","#f44336"]}},calendar:{top:80,left:50,right:30,cellSize:["auto",20],range:"2025",itemStyle:{borderWidth:.5},yearLabel:{show:!1}},series:{type:"heatmap",coordinateSystem:"calendar",calendarIndex:0,data:f}}},kt=o=>{const a=[],f=new Set,p={};for(let r=1;r<=10;r++)p[r]={total:0};o.forEach(r=>{const e=r.product_type,m=parseInt(r.priority),b=parseInt(r.order_quantity);f.add(e);let l=!1;for(let s=0;s<a.length;s++)if(a[s][0]===e&&a[s][1]===m){a[s][2]+=b,l=!0;break}l||a.push([e,m,b]),p[m][e]||(p[m][e]=0),p[m][e]+=b,p[m].total+=b});const u=Array.from(f).sort(),c=[];return u.forEach(r=>{const e=[];for(let m=1;m<=10;m++)e.push(p[m][r]||0);c.push({name:`类型 ${r}`,type:"bar",stack:"priority",emphasis:{focus:"series"},data:e})}),{title:{text:"产品类型-优先级-订单量分布",left:"center",textStyle:{fontWeight:"normal",fontSize:16}},tooltip:{position:"top",formatter:function(r){return`产品 ${r.data[0]}<br/>优先级 ${r.data[1]}<br/>订单量 ${r.data[2]}`}},animation:!0,grid:[{left:"3%",right:"43%",bottom:"10%",top:"15%",containLabel:!0},{left:"62%",right:"3%",bottom:"10%",top:"15%",containLabel:!0}],xAxis:[{type:"category",data:u,splitArea:{show:!0},name:"产品类型",gridIndex:0},{type:"value",gridIndex:1,name:"订单量"}],yAxis:[{type:"category",data:Array.from({length:10},(r,e)=>e+1),splitArea:{show:!0},name:"优先级",gridIndex:0},{type:"category",data:Array.from({length:10},(r,e)=>e+1),name:"优先级",gridIndex:1}],visualMap:{min:0,max:Math.max(...a.map(r=>r[2])),calculable:!0,orient:"horizontal",left:"center",bottom:"0%",inRange:{color:["#e8f5e9","#c8e6c9","#a5d6a7","#81c784","#66bb6a","#4caf50","#43a047","#388e3c","#2e7d32","#1b5e20"]}},series:[{name:"订单量",type:"heatmap",data:a,label:{show:!0},emphasis:{itemStyle:{shadowBlur:10,shadowColor:"rgba(0, 0, 0, 0.5)"}},xAxisIndex:0,yAxisIndex:0},...c]}},It=o=>{const a=[],f=[],p=new Set;o.forEach(e=>p.add(e.product_type)),p.forEach(e=>{a.push({name:`类型${e}`,itemStyle:{color:pt(e)}})});for(let e=1;e<=10;e++)a.push({name:`P${e}`,itemStyle:{color:vt(e)}});const u=new Set;o.forEach(e=>{const m=e.order_date.substring(5,7);u.add(m)}),u.forEach(e=>{a.push({name:`${e}月`})});const c={};o.forEach(e=>{const m=e.product_type,b=parseInt(e.priority),l=`类型${m}-P${b}`;c[l]=(c[l]||0)+parseInt(e.order_quantity)}),Object.entries(c).forEach(([e,m])=>{const[b,l]=e.split("-");f.push({source:b,target:l,value:m})});const r={};return o.forEach(e=>{const m=parseInt(e.priority),b=e.order_date.substring(5,7),l=`P${m}-${b}月`;r[l]=(r[l]||0)+parseInt(e.order_quantity)}),Object.entries(r).forEach(([e,m])=>{const[b,l]=e.split("-");f.push({source:b,target:l,value:m})}),{title:{text:"订单组合流向分析",left:"center",textStyle:{fontWeight:"normal",fontSize:16}},tooltip:{trigger:"item",triggerOn:"mousemove"},series:[{type:"sankey",emphasis:{focus:"adjacency"},nodeAlign:"right",data:a,links:f,lineStyle:{color:"source",curveness:.5}}]}},$t=()=>{z.value&&(B=L(z.value),Dt()),A.value&&(R=L(A.value),At())},Dt=()=>{const a=[...d.show_list].sort((h,v)=>new Date(h.order_date)-new Date(v.order_date)),f={};a.forEach(h=>{f[h.order_date]||(f[h.order_date]=0),f[h.order_date]+=parseInt(h.order_quantity)});const p=Object.keys(f).sort(),u=p.map(h=>f[h]),c=7,r=[];for(let h=0;h<u.length;h++){let v=0,O=0;for(let q=Math.max(0,h-c+1);q<=h;q++)v+=u[q],O++;r.push(v/O)}const e=[],m=[],b=2,l=u.reduce((h,v)=>h+v,0)/u.length,s=Math.sqrt(u.reduce((h,v)=>h+Math.pow(v-l,2),0)/u.length);u.forEach((h,v)=>{Math.abs(h-r[v])>b*s&&(e.push([v,h]),m.push(v))});const g={title:{text:"订单量异常检测",left:"center",textStyle:{fontWeight:"normal",fontSize:16}},tooltip:{trigger:"axis",formatter:function(h){const v=h[0].dataIndex;let q=`${p[v]}<br/>`;return h.forEach(N=>{q+=`${N.marker}${N.seriesName}: ${N.value}<br/>`}),m.includes(v)&&(q+='<span style="color:#ff5722;font-weight:bold">⚠️ 异常</span>'),q}},xAxis:{type:"category",data:p,boundaryGap:!1},yAxis:{type:"value",name:"订单量"},toolbox:{feature:{dataZoom:{},restore:{}}},dataZoom:[{type:"inside",start:0,end:100},{start:0,end:100}],series:[{name:"实际订单量",type:"line",data:u,lineStyle:{width:2},symbol:"emptyCircle",symbolSize:6},{name:"移动平均",type:"line",data:r,lineStyle:{width:2,type:"dashed"},symbol:"none"},{name:"异常点",type:"scatter",data:e,symbolSize:16,itemStyle:{color:"#ff5722"}}],color:["#2196f3","#4caf50","#ff5722"]};B.setOption(g)},At=()=>{const o=d.show_list,a={};o.forEach(s=>{const g=s.order_date.substring(5,7);a[g]||(a[g]={count:0,quantity:0}),a[g].count++,a[g].quantity+=parseInt(s.order_quantity)});const f=Object.keys(a).sort(),p=f.map(s=>a[s].count),u=f.map(s=>a[s].quantity),c=s=>{if(s.length<2)return[...s,s[s.length-1]];const g=s.length,h=Array.from({length:g},($,G)=>G),v=h.reduce(($,G)=>$+G,0)/g,O=s.reduce(($,G)=>$+G,0)/g;let q=0,N=0;for(let $=0;$<g;$++)q+=(h[$]-v)*(s[$]-O),N+=Math.pow(h[$]-v,2);const _t=q/N,Qt=O-_t*v,wt=[...s];for(let $=1;$<=2;$++)wt.push(_t*(g-1+$)+Qt);return wt},r=c(p),e=c(u),m=[...f],b=parseInt(f[f.length-1]);for(let s=1;s<=2;s++){let g=b+s;g>12&&(g-=12),m.push(g.toString().padStart(2,"0"))}const l={title:{text:"订单趋势预测",left:"center",textStyle:{fontWeight:"normal",fontSize:16}},tooltip:{trigger:"axis",axisPointer:{type:"cross"}},legend:{data:["订单数","订单量","预测订单数","预测订单量"],bottom:"0%"},grid:{left:"3%",right:"4%",bottom:"15%",top:"15%",containLabel:!0},xAxis:{type:"category",data:m.map(s=>`${s}月`),boundaryGap:!1},yAxis:[{type:"value",name:"订单数",position:"left"},{type:"value",name:"订单量",position:"right"}],series:[{name:"订单数",type:"line",data:p,lineStyle:{width:3},symbolSize:8},{name:"订单量",type:"line",yAxisIndex:1,data:u,lineStyle:{width:3},symbolSize:8},{name:"预测订单数",type:"line",data:Array(f.length-1).fill("-").concat(r.slice(f.length-1)),lineStyle:{width:3,type:"dashed"},symbolSize:8},{name:"预测订单量",type:"line",yAxisIndex:1,data:Array(f.length-1).fill("-").concat(e.slice(f.length-1)),lineStyle:{width:3,type:"dashed"},symbolSize:8}],color:["#3f51b5","#4caf50","#9c27b0","#ff9800"]};R.setOption(l)},Ot=o=>(o=parseInt(o),o<=3?"success":o<=6?"warning":o<=8?"orange":"error"),qt=o=>(o=parseInt(o),o<=3||o<=6?"":"white"),Pt=o=>(o=parseInt(o),o<=3?`低 (${o})`:o<=6?`中 (${o})`:o<=8?`高 (${o})`:`紧急 (${o})`),vt=o=>(o=parseInt(o),o<=3?"#4caf50":o<=6?"#ffeb3b":o<=8?"#ff9800":"#f44336"),pt=o=>({A:"#f44336",B:"#e91e63",C:"#9c27b0",D:"#673ab7",E:"#3f51b5",F:"#2196f3",G:"#03a9f4",H:"#00bcd4",I:"#009688",J:"#4caf50"})[o]||"#607d8b",zt=o=>(o=parseInt(o),o<20?"info":o<50?"success":o<80?"warning":"error"),Et=async()=>{k.value=!0,await d.update_data(),nt(),k.value=!1},Tt=()=>{Y.value={productTypes:[],priorityRange:[1,10],quantityRange:[0,100]}},Vt=()=>{x.value=!1},Mt=()=>{console.log("导出洞察")};return ft(T,()=>{y()}),ft(V,()=>{gt()}),Ft(()=>{ct(),ft(S,o=>{o&&setTimeout(()=>{$t()},100)})}),{orderStore:d,trendChart:i,categoryChart:at,priorityChart:rt,quantityPriorityChart:st,advancedAnalysisChart:lt,anomalyChart:z,forecastChart:A,isLoading:k,search:H,selectedTrendTimeframe:T,selectedAnalysisType:V,filterDialog:x,insightsDialog:S,itemsPerPage:E,filters:Y,headers:it,formattedDate:ut,filteredOrders:J,availableProductTypes:dt,keyStats:X,analysisTypes:tt,keyInsights:et,anomalies:ot,refreshData:Et,resetFilters:Tt,applyFilters:Vt,exportInsights:Mt,getPriorityColor:Ot,getPriorityTextColor:qt,getPriorityLabel:Pt,getCategoryColor:pt,getQuantityColor:zt,handleSearch:()=>{d.handleSearch(H.value)}}}}),Ut={class:"d-flex align-center"},Kt={class:"text-subtitle-2"},Yt={class:"text-h5 font-weight-bold"},Gt={ref:"trendChart",class:"chart-container"},Zt={ref:"categoryChart",class:"chart-container"},Ht={ref:"priorityChart",class:"chart-container"},Jt={ref:"quantityPriorityChart",class:"chart-container"},Xt={ref:"advancedAnalysisChart",class:"chart-container advanced-chart"},te={class:"text-caption"},ee={ref:"anomalyChart",style:{height:"300px"}},oe={class:"text-subtitle-2 mb-2"},ne={ref:"forecastChart",style:{height:"400px"}};function ae(d,i,at,rt,st,lt){const z=_("v-spacer"),A=_("v-btn"),k=_("v-card-title"),H=_("v-card-subtitle"),T=_("v-divider"),V=_("v-icon"),x=_("v-card"),S=_("v-col"),E=_("v-row"),U=_("v-btn-toggle"),I=_("v-card-text"),F=_("v-select"),K=_("v-text-field"),j=_("v-chip"),B=_("v-progress-linear"),R=_("v-data-table-server"),Y=_("v-range-slider"),it=_("v-card-actions"),J=_("v-dialog"),dt=_("v-toolbar-title"),ut=_("v-toolbar"),X=_("v-list-item-title"),tt=_("v-list-item-subtitle"),et=_("v-list-item"),ot=_("v-list"),ct=_("v-alert"),nt=_("v-container");return M(),Z(nt,{fluid:"",class:"order-dashboard pa-0"},{default:n(()=>[t(E,null,{default:n(()=>[t(S,{cols:"12"},{default:n(()=>[t(x,{class:"mb-4 rounded-lg",elevation:"2"},{default:n(()=>[t(k,{class:"text-h5 font-weight-bold primary-text"},{default:n(()=>[i[11]||(i[11]=w(" 订单数据分析仪表盘 ")),t(z),t(A,{color:"primary",variant:"tonal","prepend-icon":"mdi-refresh",onClick:d.refreshData,loading:d.isLoading},{default:n(()=>i[10]||(i[10]=[w(" 刷新数据 ")])),_:1},8,["onClick","loading"])]),_:1}),t(H,{class:"secondary-text"},{default:n(()=>[w(" 数据更新时间: "+P(d.formattedDate),1)]),_:1}),t(T),t(I,null,{default:n(()=>[t(E,{class:"mb-4 tw:-motion-translate-x-in-50 tw:-motion-translate-y-in-50 tw:motion-duration-1000 tw:motion-blur-in-lg tw:motion-ease-out"},{default:n(()=>[(M(!0),mt(yt,null,ht(d.keyStats,(y,Q)=>(M(),Z(S,{key:Q,cols:"12",sm:"6",md:"3"},{default:n(()=>[t(x,{class:"stat-card pa-4 rounded-lg",elevation:"1",color:y.color},{default:n(()=>[D("div",Ut,[t(V,{icon:y.icon,size:"large",class:"mr-3"},null,8,["icon"]),D("div",null,[D("div",Kt,P(y.title),1),D("div",Yt,P(y.value),1)])])]),_:2},1032,["color"])]),_:2},1024))),128))]),_:1}),t(E,null,{default:n(()=>[t(S,{cols:"12",md:"8",class:"tw:motion-blur-in-lg tw:-motion-translate-x-in-50 tw:-motion-translate-y-in-50 tw:motion-duration-1000 tw:motion-ease-out tw:motion-delay-100"},{default:n(()=>[t(x,{class:"rounded-lg tw:hover:!shadow-m-elevation-8 tw:hover:-translate-y-2 tw:ease-in-out tw:duration-500 tw:!transition-all",elevation:"1"},{default:n(()=>[t(k,{class:"text-subtitle-1 font-weight-bold"},{default:n(()=>[i[15]||(i[15]=w(" 订单数量趋势分析 ")),t(z),t(U,{modelValue:d.selectedTrendTimeframe,"onUpdate:modelValue":i[0]||(i[0]=y=>d.selectedTrendTimeframe=y),mandatory:"",color:"primary",density:"comfortable"},{default:n(()=>[t(A,{value:"week"},{default:n(()=>i[12]||(i[12]=[w("周")])),_:1}),t(A,{value:"month"},{default:n(()=>i[13]||(i[13]=[w("月")])),_:1}),t(A,{value:"year"},{default:n(()=>i[14]||(i[14]=[w("年")])),_:1})]),_:1},8,["modelValue"])]),_:1}),t(I,null,{default:n(()=>[D("div",Gt,null,512)]),_:1})]),_:1})]),_:1}),t(S,{cols:"12",md:"4",class:"tw:motion-blur-in-lg tw:-motion-translate-x-in-50 tw:-motion-translate-y-in-50 tw:motion-duration-1000 tw:motion-ease-out tw:motion-delay-200"},{default:n(()=>[t(x,{class:"rounded-lg tw:hover:!shadow-m-elevation-8 tw:hover:-translate-y-2 tw:ease-in-out tw:duration-500 tw:!transition-all",elevation:"1"},{default:n(()=>[t(k,{class:"text-subtitle-1 font-weight-bold"},{default:n(()=>i[16]||(i[16]=[w(" 订单类别分布 ")])),_:1}),t(I,null,{default:n(()=>[D("div",Zt,null,512)]),_:1})]),_:1})]),_:1})]),_:1}),t(E,{class:"mt-4 tw:-motion-translate-x-in-50 tw:-motion-translate-y-in-50 tw:motion-duration-1000 tw:motion-ease-out tw:motion-delay-300 tw:motion-blur-in-lg"},{default:n(()=>[t(S,{cols:"12",md:"6"},{default:n(()=>[t(x,{class:"rounded-lg tw:hover:!shadow-m-elevation-8 tw:hover:-translate-y-2 tw:ease-in-out tw:duration-500 tw:!transition-all",elevation:"1"},{default:n(()=>[t(k,{class:"text-subtitle-1 font-weight-bold"},{default:n(()=>i[17]||(i[17]=[w(" 优先级分布 ")])),_:1}),t(I,null,{default:n(()=>[D("div",Ht,null,512)]),_:1})]),_:1})]),_:1}),t(S,{cols:"12",md:"6"},{default:n(()=>[t(x,{class:"rounded-lg tw:hover:!shadow-m-elevation-8 tw:hover:-translate-y-2 tw:ease-in-out tw:duration-500 tw:!transition-all",elevation:"1"},{default:n(()=>[t(k,{class:"text-subtitle-1 font-weight-bold"},{default:n(()=>i[18]||(i[18]=[w(" 订单量与优先级关系 ")])),_:1}),t(I,null,{default:n(()=>[D("div",Jt,null,512)]),_:1})]),_:1})]),_:1})]),_:1}),t(E,{class:"mt-4"},{default:n(()=>[t(S,{cols:"12"},{default:n(()=>[t(x,{class:"rounded-lg tw:hover:!shadow-m-elevation-8 tw:hover:-translate-y-2 tw:ease-in-out tw:duration-500 tw:!transition-all",elevation:"1"},{default:n(()=>[t(k,{class:"text-subtitle-1 font-weight-bold"},{default:n(()=>[i[19]||(i[19]=w(" 高级分析 ")),t(z),t(F,{modelValue:d.selectedAnalysisType,"onUpdate:modelValue":i[1]||(i[1]=y=>d.selectedAnalysisType=y),items:d.analysisTypes,label:"分析类型",variant:"outlined","hide-details":"",density:"comfortable",class:"analysis-select"},null,8,["modelValue","items"])]),_:1}),t(I,null,{default:n(()=>[D("div",Xt,null,512)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),t(x,{class:"rounded-lg tw:hover:!shadow-m-elevation-12 tw:hover:!-translate-y-2 tw:!transition-transform tw:duration-500",elevation:"2"},{default:n(()=>[t(k,{class:"text-h6 font-weight-bold primary-text"},{default:n(()=>[i[20]||(i[20]=w(" 订单数据详情 ")),t(z),t(K,{modelValue:d.search,"onUpdate:modelValue":i[2]||(i[2]=y=>d.search=y),label:"搜索","prepend-inner-icon":"mdi-magnify",variant:"outlined","hide-details":"",density:"comfortable",class:"search-field",onKeyup:jt(d.handleSearch,["enter"])},null,8,["modelValue","onKeyup"])]),_:1}),t(R,{"items-per-page":d.itemsPerPage,"onUpdate:itemsPerPage":i[3]||(i[3]=y=>d.itemsPerPage=y),headers:d.headers,items:d.filteredOrders,search:d.search,class:"elevation-1 mt-2","item-value":"order_id","hide-default-footer":""},{"item.priority":n(({item:y})=>[t(j,{color:d.getPriorityColor(y.priority),"text-color":d.getPriorityTextColor(y.priority),size:"small"},{default:n(()=>[w(P(d.getPriorityLabel(y.priority)),1)]),_:2},1032,["color","text-color"])]),"item.product_type":n(({item:y})=>[t(j,{color:d.getCategoryColor(y.product_type),size:"small",variant:"tonal"},{default:n(()=>[w(P(y.product_type),1)]),_:2},1032,["color"])]),"item.order_quantity":n(({item:y})=>[t(B,{"model-value":y.order_quantity,color:d.getQuantityColor(y.order_quantity),height:"8",rounded:"",class:"mt-2 mb-2"},null,8,["model-value","color"]),D("span",te,P(y.order_quantity),1)]),_:1},8,["items-per-page","headers","items","search"])]),_:1})]),_:1})]),_:1}),t(J,{modelValue:d.filterDialog,"onUpdate:modelValue":i[7]||(i[7]=y=>d.filterDialog=y),"max-width":"600"},{default:n(()=>[t(x,null,{default:n(()=>[t(k,{class:"text-h6"},{default:n(()=>i[21]||(i[21]=[w("高级筛选")])),_:1}),t(I,null,{default:n(()=>[t(E,null,{default:n(()=>[t(S,{cols:"12",sm:"6"},{default:n(()=>[t(F,{modelValue:d.filters.productTypes,"onUpdate:modelValue":i[4]||(i[4]=y=>d.filters.productTypes=y),items:d.availableProductTypes,label:"产品类型",multiple:"",chips:"",variant:"outlined"},null,8,["modelValue","items"])]),_:1}),t(S,{cols:"12",sm:"6"},{default:n(()=>[t(Y,{modelValue:d.filters.priorityRange,"onUpdate:modelValue":i[5]||(i[5]=y=>d.filters.priorityRange=y),label:"优先级范围",min:"1",max:"10",step:"1","thumb-label":"always"},null,8,["modelValue"])]),_:1}),t(S,{cols:"12"},{default:n(()=>[t(Y,{modelValue:d.filters.quantityRange,"onUpdate:modelValue":i[6]||(i[6]=y=>d.filters.quantityRange=y),label:"数量范围",min:"0",max:"100",step:"1","thumb-label":"always"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),t(it,null,{default:n(()=>[t(z),t(A,{color:"primary",variant:"text",onClick:d.resetFilters},{default:n(()=>i[22]||(i[22]=[w("重置")])),_:1},8,["onClick"]),t(A,{color:"primary",onClick:d.applyFilters},{default:n(()=>i[23]||(i[23]=[w("应用")])),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),t(J,{modelValue:d.insightsDialog,"onUpdate:modelValue":i[9]||(i[9]=y=>d.insightsDialog=y),fullscreen:""},{default:n(()=>[t(x,null,{default:n(()=>[t(ut,{color:"primary"},{default:n(()=>[t(A,{icon:"",onClick:i[8]||(i[8]=y=>d.insightsDialog=!1)},{default:n(()=>[t(V,null,{default:n(()=>i[24]||(i[24]=[w("mdi-close")])),_:1})]),_:1}),t(dt,null,{default:n(()=>i[25]||(i[25]=[w("数据洞察")])),_:1}),t(z),t(A,{icon:"",onClick:d.exportInsights},{default:n(()=>[t(V,null,{default:n(()=>i[26]||(i[26]=[w("mdi-export")])),_:1})]),_:1},8,["onClick"])]),_:1}),t(I,null,{default:n(()=>[t(E,null,{default:n(()=>[t(S,{cols:"12",md:"6"},{default:n(()=>[t(x,{class:"mb-4"},{default:n(()=>[t(k,{class:"text-subtitle-1"},{default:n(()=>i[27]||(i[27]=[w("关键见解")])),_:1}),t(I,null,{default:n(()=>[t(ot,{lines:"two"},{default:n(()=>[(M(!0),mt(yt,null,ht(d.keyInsights,(y,Q)=>(M(),Z(et,{key:Q},{prepend:n(()=>[t(V,{color:y.color,icon:y.icon},null,8,["color","icon"])]),default:n(()=>[t(X,null,{default:n(()=>[w(P(y.title),1)]),_:2},1024),t(tt,null,{default:n(()=>[w(P(y.description),1)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1})]),_:1}),t(S,{cols:"12",md:"6"},{default:n(()=>[t(x,null,{default:n(()=>[t(k,{class:"text-subtitle-1"},{default:n(()=>i[28]||(i[28]=[w("异常检测")])),_:1}),t(I,null,{default:n(()=>[D("div",ee,null,512),d.anomalies.length>0?(M(),Z(ct,{key:0,color:"warning",variant:"tonal",class:"mt-4"},{default:n(()=>[D("div",oe,"检测到 "+P(d.anomalies.length)+" 个潜在异常",1),t(ot,{density:"compact"},{default:n(()=>[(M(!0),mt(yt,null,ht(d.anomalies,(y,Q)=>(M(),Z(et,{key:Q},{default:n(()=>[t(X,null,{default:n(()=>[w(P(y.description),1)]),_:2},1024),t(tt,null,{default:n(()=>[w("订单 #"+P(y.order_id),1)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})):Bt("",!0)]),_:1})]),_:1})]),_:1})]),_:1}),t(E,{class:"mt-4"},{default:n(()=>[t(S,{cols:"12"},{default:n(()=>[t(x,null,{default:n(()=>[t(k,{class:"text-subtitle-1"},{default:n(()=>i[29]||(i[29]=[w("预测分析")])),_:1}),t(I,null,{default:n(()=>[D("div",ne,null,512)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})}const pe=Wt(Nt,[["render",ae],["__scopeId","data-v-69746f45"]]);export{pe as default};
