import{_ as Lt,E as Wt,c as H,w as n,i as C,a as M,x as ft,k as jt,r as b,o as T,d as t,g as _,t as P,e as yt,F as mt,f as ht,b as A,y as Ft,p as Rt}from"./index-kmKPHIKf.js";import{u as Bt}from"./order-CakmNsEV.js";import{i as Q}from"./index-DkaH_rt3.js";import"./OderManagement-Cbu9FEJg.js";import"./useSocket-DSyTKqUj.js";import"./RosLib-C7gnwWt6.js";const Ut=Wt({name:"OrderAnalyticsDashboard",setup(){const d=Bt(),i=C(null),at=C(null),rt=C(null),st=C(null),lt=C(null),D=C(null),q=C(null),I=C(!1),J=C(""),L=C("month"),E=C("产品类型与订单量相关性"),w=C(!1),S=C(!1),z=C(10);let N=null,k=null,W=null,K=null,j=null,F=null,R=null;const G=C({productTypes:[],priorityRange:[1,10],quantityRange:[0,100]}),it=C([{title:"订单号",key:"order_id",sortable:!0},{title:"产品类型",key:"product_type",sortable:!0},{title:"数量",key:"order_quantity",sortable:!0},{title:"日期",key:"order_date",sortable:!0},{title:"优先级",key:"priority",sortable:!0}]),X=M(()=>d.show_list),dt=M(()=>{const o=new Set;return d.show_list.forEach(a=>{o.add(a.product_type)}),Array.from(o)}),ct=M(()=>new Date().toLocaleString("zh-CN")),Y=M(()=>{const o=d.show_list;if(!o.length)return[];const a=o.length,f=o.reduce((u,r)=>u+parseInt(r.order_quantity),0),p=o.reduce((u,r)=>u+parseInt(r.priority),0)/a,c=o.filter(u=>parseInt(u.priority)>=8).length;return[{title:"总订单数",value:a,icon:"mdi-clipboard-list",color:"bg-blue-lighten-5"},{title:"总订单量",value:f,icon:"mdi-package-variant",color:"bg-green-lighten-5"},{title:"平均优先级",value:p.toFixed(1),icon:"mdi-alert-circle",color:"bg-orange-lighten-5"},{title:"高优先级订单",value:c,icon:"mdi-flag",color:"bg-red-lighten-5"}]}),tt=M(()=>["产品类型与订单量相关性","优先级与日期分布","订单量分布热力图","订单组合分析"]),et=M(()=>{const o=d.show_list;if(!o.length)return[];const a={};o.forEach(s=>{a[s.product_type]=(a[s.product_type]||0)+1});let f="",p=0;Object.entries(a).forEach(([s,l])=>{l>p&&(p=l,f=s)});const c={};o.forEach(s=>{const l=s.order_date.substring(5,7);c[l]||(c[l]={total:0,count:0}),c[l].total+=parseInt(s.priority),c[l].count+=1});let u=!0,r=0;Object.values(c).forEach(({total:s,count:l},v)=>{const g=s/l;v>0&&g<r&&(u=!1),r=g});const e={};o.forEach(s=>{const l=s.order_date.substring(5,7);e[l]||(e[l]=0),e[l]+=parseInt(s.order_quantity)});const y=Object.keys(e).sort(),h=y.length>=2&&e[y[y.length-1]]>e[y[0]];return[{title:`最受欢迎的产品类型是 ${f}`,description:`占总订单的 ${(p/o.length*100).toFixed(1)}%`,icon:"mdi-trophy",color:"amber"},{title:`订单优先级趋势${u?"上升":"下降"}`,description:`整体优先级${u?"逐月增加，需加强资源投入":"逐月下降，压力有所缓解"}`,icon:u?"mdi-trending-up":"mdi-trending-down",color:u?"red":"green"},{title:`订单量${h?"呈增长趋势":"呈下降趋势"}`,description:h?"整体订单量增长，显示业务扩张":"整体订单量下降，需要关注销售情况",icon:h?"mdi-chart-line-variant":"mdi-chart-line-variant-decrease",color:h?"blue":"deep-orange"}]}),ot=M(()=>{const o=d.show_list;if(!o.length)return[];const a=[],f=o.map(u=>parseInt(u.order_quantity)),p=f.reduce((u,r)=>u+r,0)/f.length,c=Math.sqrt(f.reduce((u,r)=>u+Math.pow(r-p,2),0)/f.length);return o.forEach(u=>{const r=parseInt(u.order_quantity);Math.abs(r-p)>3*c&&a.push({order_id:u.order_id,description:`订单量异常${r>p?"高":"低"} (${r})`});const e=parseInt(u.priority);e>=9&&r<p/2&&a.push({order_id:u.order_id,description:`高优先级(${e})但低订单量(${r})`})}),a}),ut=()=>{N=Q(i.value),k=Q(at.value),W=Q(rt.value),K=Q(st.value),j=Q(lt.value),nt(),window.addEventListener("resize",()=>{N.resize(),k.resize(),W.resize(),K.resize(),j.resize(),F&&F.resize(),R&&R.resize()})},nt=()=>{d.show_list.length&&(m(),V(),wt(),St(),gt())},m=()=>{const o=d.show_list;let a,f;L.value==="week"?(a=s=>{const l=new Date(s);return new Date(l).setDate(l.getDate()-l.getDay()),`第${Math.ceil(l.getDate()/7)}周`},f=s=>{const l=new Date(s);return Math.ceil(l.getDate()/7)}):L.value==="month"?(a=s=>s.substring(5,7)+"月",f=s=>s.substring(5,7)):(a=s=>s.substring(0,4)+"年",f=s=>s.substring(0,4));const p={},c={},u={};o.forEach(s=>{const l=f(s.order_date);p[l]||(p[l]=0,c[l]=0,u[l]={}),p[l]++,c[l]+=parseInt(s.order_quantity);const v=s.product_type;u[l][v]=(u[l][v]||0)+1});const r=new Set;o.forEach(s=>r.add(s.product_type));const e=Object.keys(p).sort((s,l)=>s-l),y=[{name:"订单数",type:"line",smooth:!0,lineStyle:{width:3},symbolSize:8,data:e.map(s=>p[s]),z:3},{name:"订单量",type:"line",smooth:!0,lineStyle:{width:3,type:"dashed"},symbolSize:8,yAxisIndex:1,data:e.map(s=>c[s]),z:2}];Array.from(r).forEach(s=>{y.push({name:`类型 ${s}`,type:"bar",stack:"产品类型",emphasis:{focus:"series"},data:e.map(l=>u[l][s]||0),z:1})});const h={title:{text:"订单趋势分析",left:"center",textStyle:{fontWeight:"normal",fontSize:16}},tooltip:{trigger:"axis",axisPointer:{type:"cross",label:{backgroundColor:"#6a7985"}}},legend:{data:["订单数","订单量",...Array.from(r).map(s=>`类型 ${s}`)],bottom:"0%",type:"scroll"},toolbox:{feature:{saveAsImage:{},dataZoom:{},restore:{}}},grid:{left:"3%",right:"4%",bottom:"15%",top:"15%",containLabel:!0},xAxis:{type:"category",boundaryGap:!0,data:e.map(s=>a(s))},yAxis:[{type:"value",name:"订单数",position:"left"},{type:"value",name:"订单量",position:"right"}],series:y,color:["#3f51b5","#4caf50","#f44336","#ff9800","#9c27b0","#00bcd4","#ffeb3b","#795548","#607d8b","#e91e63"]};N.setOption(h)},V=()=>{const o=d.show_list,a={};o.forEach(c=>{const u=c.product_type;a[u]||(a[u]={count:0,quantity:0}),a[u].count++,a[u].quantity+=parseInt(c.order_quantity)});const f=Object.keys(a).sort(),p={title:{text:"产品类型分布",left:"center",textStyle:{fontWeight:"normal",fontSize:16}},tooltip:{trigger:"item",formatter:"{b}: {c} ({d}%)"},legend:{orient:"vertical",left:10,top:"middle",type:"scroll",formatter:c=>{const u=(a[c].count/o.length*100).toFixed(1);return`${c} (${u}%)`}},series:[{name:"产品类型",type:"pie",radius:["40%","70%"],center:["60%","50%"],avoidLabelOverlap:!1,itemStyle:{borderRadius:10,borderColor:"#fff",borderWidth:2},label:{show:!1,position:"center"},emphasis:{label:{show:!0,fontSize:"14",fontWeight:"bold"}},labelLine:{show:!1},data:f.map(c=>({name:c,value:a[c].count}))}],color:["#f44336","#e91e63","#9c27b0","#673ab7","#3f51b5","#2196f3","#03a9f4","#00bcd4","#009688","#4caf50"]};k.setOption(p)},wt=()=>{const o=d.show_list,a={};for(let p=1;p<=10;p++)a[p]=0;o.forEach(p=>{const c=parseInt(p.priority);a[c]++});const f={title:{text:"订单优先级分布",left:"center",textStyle:{fontWeight:"normal",fontSize:16}},tooltip:{trigger:"axis",axisPointer:{type:"shadow"}},grid:{left:"3%",right:"4%",bottom:"3%",top:"15%",containLabel:!0},xAxis:{type:"category",data:Object.keys(a),axisTick:{alignWithLabel:!0},name:"优先级"},yAxis:{type:"value",name:"订单数"},visualMap:{orient:"horizontal",left:"center",bottom:0,min:1,max:10,text:["高优先级","低优先级"],dimension:0,inRange:{color:["#4caf50","#ffeb3b","#f44336"]},show:!1},series:[{name:"订单数",type:"bar",barWidth:"60%",data:Object.entries(a).map(([p,c])=>({value:c,itemStyle:{color:_t(p)}}))}]};W.setOption(f)},St=()=>{const o=d.show_list,a=o.map(r=>[parseInt(r.order_quantity),parseInt(r.priority),r.product_type,r.order_id]),f=o.map(r=>parseInt(r.order_quantity)),p=Math.min(...f),c=Math.max(...f),u={title:{text:"订单量与优先级关系",left:"center",textStyle:{fontWeight:"normal",fontSize:16}},tooltip:{trigger:"item",formatter:function(r){const e=r.data;return`订单号: ${e[3]}<br/>产品类型: ${e[2]}<br/>订单量: ${e[0]}<br/>优先级: ${e[1]}`}},grid:{left:"3%",right:"4%",bottom:"10%",top:"15%",containLabel:!0},xAxis:{type:"value",name:"订单量",min:p,max:c},yAxis:{type:"value",name:"优先级",min:1,max:10},toolbox:{feature:{dataZoom:{},restore:{}}},series:[{type:"scatter",symbolSize:function(r){return Math.sqrt(r[0])*1.5+5},itemStyle:{color:function(r){return pt(r.data[2])},opacity:.8},emphasis:{focus:"series",itemStyle:{opacity:1}},data:a}]};K.setOption(u)},gt=()=>{const o=d.show_list;if(!o.length)return;let a={};switch(E.value){case"产品类型与订单量相关性":a=bt(o);break;case"优先级与日期分布":a=Ct(o);break;case"订单量分布热力图":a=It(o);break;case"订单组合分析":a=kt(o);break;default:a=bt(o)}j.setOption(a)},bt=o=>{const a={};o.forEach(e=>{const y=e.product_type;a[y]||(a[y]={orders:0,totalQuantity:0,totalPriority:0,quantities:[]}),a[y].orders++;const h=parseInt(e.order_quantity),s=parseInt(e.priority);a[y].totalQuantity+=h,a[y].totalPriority+=s,a[y].quantities.push(h)});const f=Object.keys(a).sort(),p=f.map(e=>a[e].totalQuantity/a[e].orders),c=f.map(e=>a[e].totalPriority/a[e].orders),u=f.map(e=>a[e].orders),r=f.map(e=>{const y=a[e].totalQuantity/a[e].orders,h=a[e].quantities,s=h.reduce((l,v)=>l+Math.pow(v-y,2),0)/h.length;return Math.sqrt(s)});return{title:{text:"产品类型分析",left:"center",textStyle:{fontWeight:"normal",fontSize:16}},tooltip:{trigger:"axis",axisPointer:{type:"cross"},formatter:function(e){let y=`${e[0].axisValue}<br/>`;return e.forEach(h=>{const s=`<span style="display:inline-block;margin-right:5px;border-radius:10px;width:10px;height:10px;background-color:${h.color};"></span>`;y+=`${s}${h.seriesName}: ${h.value.toFixed(2)}<br/>`}),y+=`<span style="display:inline-block;margin-right:5px;border-radius:10px;width:10px;height:10px;background-color:#ff9800;"></span>订单数: ${u[e[0].dataIndex]}<br/>`,y}},toolbox:{feature:{saveAsImage:{},dataView:{readOnly:!0}}},legend:{data:["平均订单量","平均优先级","订单量标准差"],bottom:"0%"},grid:{left:"3%",right:"4%",bottom:"10%",top:"15%",containLabel:!0},xAxis:{type:"category",name:"产品类型",data:f,axisPointer:{type:"shadow"}},yAxis:[{type:"value",name:"平均订单量",position:"left"},{type:"value",name:"平均优先级",min:1,max:10,position:"right",axisLine:{lineStyle:{color:"#ff5722"}}}],series:[{name:"平均订单量",type:"bar",data:p},{name:"平均优先级",type:"line",yAxisIndex:1,lineStyle:{width:3},symbolSize:8,data:c},{name:"订单量标准差",type:"line",lineStyle:{width:3,type:"dashed"},symbolSize:8,data:r},{name:"订单数",type:"bar",stack:"订单",emphasis:{focus:"series"},data:u,z:-1,opacity:.3,tooltip:{show:!1}}],color:["#3f51b5","#ff5722","#4caf50","#ff9800"]}},Ct=o=>{const a={};o.forEach(p=>{const c=p.order_date,u=c.substring(5,7),r=c.substring(8,10),e=`${u}-${r}`;a[e]||(a[e]={count:0,totalPriority:0,totalQuantity:0}),a[e].count++,a[e].totalPriority+=parseInt(p.priority),a[e].totalQuantity+=parseInt(p.order_quantity)});const f=Object.entries(a).map(([p,c])=>{const[u,r]=p.split("-");return[`2025-${u}-${r}`,c.totalPriority/c.count]});return{title:{text:"订单优先级日历分布",left:"center",textStyle:{fontWeight:"normal",fontSize:16}},tooltip:{formatter:function(p){const c=p.value[0],u=p.value[1],r=c.substring(5);return`${c}<br/>平均优先级: ${u.toFixed(2)}<br/>订单数: ${a[r]?.count||0}`}},visualMap:{min:1,max:10,calculable:!0,orient:"horizontal",left:"center",bottom:20,inRange:{color:["#4caf50","#ffeb3b","#ff9800","#f44336"]}},calendar:{top:80,left:50,right:30,cellSize:["auto",20],range:"2025",itemStyle:{borderWidth:.5},yearLabel:{show:!1}},series:{type:"heatmap",coordinateSystem:"calendar",calendarIndex:0,data:f}}},It=o=>{const a=[],f=new Set,p={};for(let r=1;r<=10;r++)p[r]={total:0};o.forEach(r=>{const e=r.product_type,y=parseInt(r.priority),h=parseInt(r.order_quantity);f.add(e);let s=!1;for(let l=0;l<a.length;l++)if(a[l][0]===e&&a[l][1]===y){a[l][2]+=h,s=!0;break}s||a.push([e,y,h]),p[y][e]||(p[y][e]=0),p[y][e]+=h,p[y].total+=h});const c=Array.from(f).sort(),u=[];return c.forEach(r=>{const e=[];for(let y=1;y<=10;y++)e.push(p[y][r]||0);u.push({name:`类型 ${r}`,type:"bar",stack:"priority",emphasis:{focus:"series"},data:e})}),{title:{text:"产品类型-优先级-订单量分布",left:"center",textStyle:{fontWeight:"normal",fontSize:16}},tooltip:{position:"top",formatter:function(r){return`产品 ${r.data[0]}<br/>优先级 ${r.data[1]}<br/>订单量 ${r.data[2]}`}},animation:!0,grid:[{left:"3%",right:"43%",bottom:"10%",top:"15%",containLabel:!0},{left:"62%",right:"3%",bottom:"10%",top:"15%",containLabel:!0}],xAxis:[{type:"category",data:c,splitArea:{show:!0},name:"产品类型",gridIndex:0},{type:"value",gridIndex:1,name:"订单量"}],yAxis:[{type:"category",data:Array.from({length:10},(r,e)=>e+1),splitArea:{show:!0},name:"优先级",gridIndex:0},{type:"category",data:Array.from({length:10},(r,e)=>e+1),name:"优先级",gridIndex:1}],visualMap:{min:0,max:Math.max(...a.map(r=>r[2])),calculable:!0,orient:"horizontal",left:"center",bottom:"0%",inRange:{color:["#e8f5e9","#c8e6c9","#a5d6a7","#81c784","#66bb6a","#4caf50","#43a047","#388e3c","#2e7d32","#1b5e20"]}},series:[{name:"订单量",type:"heatmap",data:a,label:{show:!0},emphasis:{itemStyle:{shadowBlur:10,shadowColor:"rgba(0, 0, 0, 0.5)"}},xAxisIndex:0,yAxisIndex:0},...u]}},kt=o=>{const a=[],f=[],p=new Set;o.forEach(e=>p.add(e.product_type)),p.forEach(e=>{a.push({name:`类型${e}`,itemStyle:{color:pt(e)}})});for(let e=1;e<=10;e++)a.push({name:`P${e}`,itemStyle:{color:_t(e)}});const c=new Set;o.forEach(e=>{const y=e.order_date.substring(5,7);c.add(y)}),c.forEach(e=>{a.push({name:`${e}月`})});const u={};o.forEach(e=>{const y=e.product_type,h=parseInt(e.priority),s=`类型${y}-P${h}`;u[s]=(u[s]||0)+parseInt(e.order_quantity)}),Object.entries(u).forEach(([e,y])=>{const[h,s]=e.split("-");f.push({source:h,target:s,value:y})});const r={};return o.forEach(e=>{const y=parseInt(e.priority),h=e.order_date.substring(5,7),s=`P${y}-${h}月`;r[s]=(r[s]||0)+parseInt(e.order_quantity)}),Object.entries(r).forEach(([e,y])=>{const[h,s]=e.split("-");f.push({source:h,target:s,value:y})}),{title:{text:"订单组合流向分析",left:"center",textStyle:{fontWeight:"normal",fontSize:16}},tooltip:{trigger:"item",triggerOn:"mousemove"},series:[{type:"sankey",emphasis:{focus:"adjacency"},nodeAlign:"right",data:a,links:f,lineStyle:{color:"source",curveness:.5}}]}},$t=()=>{D.value&&(F=Q(D.value),At()),q.value&&(R=Q(q.value),qt())},At=()=>{const a=[...d.show_list].sort((g,x)=>new Date(g.order_date)-new Date(x.order_date)),f={};a.forEach(g=>{f[g.order_date]||(f[g.order_date]=0),f[g.order_date]+=parseInt(g.order_quantity)});const p=Object.keys(f).sort(),c=p.map(g=>f[g]),u=7,r=[];for(let g=0;g<c.length;g++){let x=0,B=0;for(let O=Math.max(0,g-u+1);O<=g;O++)x+=c[O],B++;r.push(x/B)}const e=[],y=[],h=2,s=c.reduce((g,x)=>g+x,0)/c.length,l=Math.sqrt(c.reduce((g,x)=>g+Math.pow(x-s,2),0)/c.length);c.forEach((g,x)=>{Math.abs(g-r[x])>h*l&&(e.push([x,g]),y.push(x))});const v={title:{text:"订单量异常检测",left:"center",textStyle:{fontWeight:"normal",fontSize:16}},tooltip:{trigger:"axis",formatter:function(g){const x=g[0].dataIndex;let O=`${p[x]}<br/>`;return g.forEach(U=>{O+=`${U.marker}${U.seriesName}: ${U.value}<br/>`}),y.includes(x)&&(O+='<span style="color:#ff5722;font-weight:bold">⚠️ 异常</span>'),O}},xAxis:{type:"category",data:p,boundaryGap:!1},yAxis:{type:"value",name:"订单量"},toolbox:{feature:{dataZoom:{},restore:{}}},dataZoom:[{type:"inside",start:0,end:100},{start:0,end:100}],series:[{name:"实际订单量",type:"line",data:c,lineStyle:{width:2},symbol:"emptyCircle",symbolSize:6},{name:"移动平均",type:"line",data:r,lineStyle:{width:2,type:"dashed"},symbol:"none"},{name:"异常点",type:"scatter",data:e,symbolSize:16,itemStyle:{color:"#ff5722"}}],color:["#2196f3","#4caf50","#ff5722"]};F.setOption(v)},qt=()=>{const o=d.show_list,a={};o.forEach(l=>{const v=l.order_date.substring(5,7);a[v]||(a[v]={count:0,quantity:0}),a[v].count++,a[v].quantity+=parseInt(l.order_quantity)});const f=Object.keys(a).sort(),p=f.map(l=>a[l].count),c=f.map(l=>a[l].quantity),u=l=>{if(l.length<2)return[...l,l[l.length-1]];const v=l.length,g=Array.from({length:v},($,Z)=>Z),x=g.reduce(($,Z)=>$+Z,0)/v,B=l.reduce(($,Z)=>$+Z,0)/v;let O=0,U=0;for(let $=0;$<v;$++)O+=(g[$]-x)*(l[$]-B),U+=Math.pow(g[$]-x,2);const vt=O/U,Qt=B-vt*x,xt=[...l];for(let $=1;$<=2;$++)xt.push(vt*(v-1+$)+Qt);return xt},r=u(p),e=u(c),y=[...f],h=parseInt(f[f.length-1]);for(let l=1;l<=2;l++){let v=h+l;v>12&&(v-=12),y.push(v.toString().padStart(2,"0"))}const s={title:{text:"订单趋势预测",left:"center",textStyle:{fontWeight:"normal",fontSize:16}},tooltip:{trigger:"axis",axisPointer:{type:"cross"}},legend:{data:["订单数","订单量","预测订单数","预测订单量"],bottom:"0%"},grid:{left:"3%",right:"4%",bottom:"15%",top:"15%",containLabel:!0},xAxis:{type:"category",data:y.map(l=>`${l}月`),boundaryGap:!1},yAxis:[{type:"value",name:"订单数",position:"left"},{type:"value",name:"订单量",position:"right"}],series:[{name:"订单数",type:"line",data:p,lineStyle:{width:3},symbolSize:8},{name:"订单量",type:"line",yAxisIndex:1,data:c,lineStyle:{width:3},symbolSize:8},{name:"预测订单数",type:"line",data:Array(f.length-1).fill("-").concat(r.slice(f.length-1)),lineStyle:{width:3,type:"dashed"},symbolSize:8},{name:"预测订单量",type:"line",yAxisIndex:1,data:Array(f.length-1).fill("-").concat(e.slice(f.length-1)),lineStyle:{width:3,type:"dashed"},symbolSize:8}],color:["#3f51b5","#4caf50","#9c27b0","#ff9800"]};R.setOption(s)},Pt=o=>(o=parseInt(o),o<=3?"success":o<=6?"warning":o<=8?"orange":"error"),Dt=o=>(o=parseInt(o),o<=3||o<=6?"":"white"),zt=o=>(o=parseInt(o),o<=3?`低 (${o})`:o<=6?`中 (${o})`:o<=8?`高 (${o})`:`紧急 (${o})`),_t=o=>(o=parseInt(o),o<=3?"#4caf50":o<=6?"#ffeb3b":o<=8?"#ff9800":"#f44336"),pt=o=>({A:"#f44336",B:"#e91e63",C:"#9c27b0",D:"#673ab7",E:"#3f51b5",F:"#2196f3",G:"#03a9f4",H:"#00bcd4",I:"#009688",J:"#4caf50"})[o]||"#607d8b",Ot=o=>(o=parseInt(o),o<20?"info":o<50?"success":o<80?"warning":"error"),Et=async()=>{I.value=!0,await d.update_data(),nt(),I.value=!1},Tt=()=>{G.value={productTypes:[],priorityRange:[1,10],quantityRange:[0,100]}},Vt=()=>{w.value=!1},Mt=()=>{console.log("导出洞察")};return ft(L,()=>{m()}),ft(E,()=>{gt()}),jt(()=>{ut(),ft(S,o=>{o&&setTimeout(()=>{$t()},100)})}),{orderStore:d,trendChart:i,categoryChart:at,priorityChart:rt,quantityPriorityChart:st,advancedAnalysisChart:lt,anomalyChart:D,forecastChart:q,isLoading:I,search:J,selectedTrendTimeframe:L,selectedAnalysisType:E,filterDialog:w,insightsDialog:S,itemsPerPage:z,filters:G,headers:it,formattedDate:ct,filteredOrders:X,availableProductTypes:dt,keyStats:Y,analysisTypes:tt,keyInsights:et,anomalies:ot,refreshData:Et,resetFilters:Tt,applyFilters:Vt,exportInsights:Mt,getPriorityColor:Pt,getPriorityTextColor:Dt,getPriorityLabel:zt,getCategoryColor:pt,getQuantityColor:Ot,handleSearch:()=>{d.handleSearch(J.value)}}}}),Nt={class:"d-flex align-center"},Kt={class:"text-subtitle-2"},Gt={class:"text-h5 font-weight-bold"},Zt={ref:"trendChart",class:"chart-container"},Ht={ref:"categoryChart",class:"chart-container"},Jt={ref:"priorityChart",class:"chart-container"},Xt={ref:"quantityPriorityChart",class:"chart-container"},Yt={ref:"advancedAnalysisChart",class:"chart-container advanced-chart"},te={class:"text-caption"},ee={ref:"anomalyChart",style:{height:"300px"}},oe={class:"text-subtitle-2 mb-2"},ne={ref:"forecastChart",style:{height:"400px"}};function ae(d,i,at,rt,st,lt){const D=b("v-spacer"),q=b("v-btn"),I=b("v-card-title"),J=b("v-card-subtitle"),L=b("v-divider"),E=b("v-icon"),w=b("v-card"),S=b("v-col"),z=b("v-row"),N=b("v-btn-toggle"),k=b("v-card-text"),W=b("v-select"),K=b("v-text-field"),j=b("v-chip"),F=b("v-progress-linear"),R=b("v-data-table-server"),G=b("v-range-slider"),it=b("v-card-actions"),X=b("v-dialog"),dt=b("v-toolbar-title"),ct=b("v-toolbar"),Y=b("v-list-item-title"),tt=b("v-list-item-subtitle"),et=b("v-list-item"),ot=b("v-list"),ut=b("v-alert"),nt=b("v-container");return T(),H(nt,{fluid:"",class:"order-dashboard pa-0"},{default:n(()=>[t(z,null,{default:n(()=>[t(S,{cols:"12"},{default:n(()=>[t(w,{class:"mb-4 rounded-lg",elevation:"2"},{default:n(()=>[t(I,{class:"text-h5 font-weight-bold primary-text"},{default:n(()=>[i[11]||(i[11]=_(" 订单数据分析仪表盘 ")),t(D),t(q,{color:"primary",variant:"tonal","prepend-icon":"mdi-refresh",onClick:d.refreshData,loading:d.isLoading},{default:n(()=>i[10]||(i[10]=[_(" 刷新数据 ")])),_:1},8,["onClick","loading"])]),_:1}),t(J,{class:"secondary-text"},{default:n(()=>[_(" 数据更新时间: "+P(d.formattedDate),1)]),_:1}),t(L),t(k,null,{default:n(()=>[t(z,{class:"mb-4"},{default:n(()=>[(T(!0),yt(mt,null,ht(d.keyStats,(m,V)=>(T(),H(S,{key:V,cols:"12",sm:"6",md:"3"},{default:n(()=>[t(w,{class:"stat-card pa-4 rounded-lg",elevation:"1",color:m.color},{default:n(()=>[A("div",Nt,[t(E,{icon:m.icon,size:"large",class:"mr-3"},null,8,["icon"]),A("div",null,[A("div",Kt,P(m.title),1),A("div",Gt,P(m.value),1)])])]),_:2},1032,["color"])]),_:2},1024))),128))]),_:1}),t(z,null,{default:n(()=>[t(S,{cols:"12",md:"8"},{default:n(()=>[t(w,{class:"rounded-lg",elevation:"1"},{default:n(()=>[t(I,{class:"text-subtitle-1 font-weight-bold"},{default:n(()=>[i[15]||(i[15]=_(" 订单数量趋势分析 ")),t(D),t(N,{modelValue:d.selectedTrendTimeframe,"onUpdate:modelValue":i[0]||(i[0]=m=>d.selectedTrendTimeframe=m),mandatory:"",color:"primary",density:"comfortable"},{default:n(()=>[t(q,{value:"week"},{default:n(()=>i[12]||(i[12]=[_("周")])),_:1}),t(q,{value:"month"},{default:n(()=>i[13]||(i[13]=[_("月")])),_:1}),t(q,{value:"year"},{default:n(()=>i[14]||(i[14]=[_("年")])),_:1})]),_:1},8,["modelValue"])]),_:1}),t(k,null,{default:n(()=>[A("div",Zt,null,512)]),_:1})]),_:1})]),_:1}),t(S,{cols:"12",md:"4"},{default:n(()=>[t(w,{class:"rounded-lg",elevation:"1"},{default:n(()=>[t(I,{class:"text-subtitle-1 font-weight-bold"},{default:n(()=>i[16]||(i[16]=[_(" 订单类别分布 ")])),_:1}),t(k,null,{default:n(()=>[A("div",Ht,null,512)]),_:1})]),_:1})]),_:1})]),_:1}),t(z,{class:"mt-4"},{default:n(()=>[t(S,{cols:"12",md:"6"},{default:n(()=>[t(w,{class:"rounded-lg",elevation:"1"},{default:n(()=>[t(I,{class:"text-subtitle-1 font-weight-bold"},{default:n(()=>i[17]||(i[17]=[_(" 优先级分布 ")])),_:1}),t(k,null,{default:n(()=>[A("div",Jt,null,512)]),_:1})]),_:1})]),_:1}),t(S,{cols:"12",md:"6"},{default:n(()=>[t(w,{class:"rounded-lg",elevation:"1"},{default:n(()=>[t(I,{class:"text-subtitle-1 font-weight-bold"},{default:n(()=>i[18]||(i[18]=[_(" 订单量与优先级关系 ")])),_:1}),t(k,null,{default:n(()=>[A("div",Xt,null,512)]),_:1})]),_:1})]),_:1})]),_:1}),t(z,{class:"mt-4"},{default:n(()=>[t(S,{cols:"12"},{default:n(()=>[t(w,{class:"rounded-lg",elevation:"1"},{default:n(()=>[t(I,{class:"text-subtitle-1 font-weight-bold"},{default:n(()=>[i[19]||(i[19]=_(" 高级分析 ")),t(D),t(W,{modelValue:d.selectedAnalysisType,"onUpdate:modelValue":i[1]||(i[1]=m=>d.selectedAnalysisType=m),items:d.analysisTypes,label:"分析类型",variant:"outlined","hide-details":"",density:"comfortable",class:"analysis-select"},null,8,["modelValue","items"])]),_:1}),t(k,null,{default:n(()=>[A("div",Yt,null,512)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),t(w,{class:"rounded-lg",elevation:"2"},{default:n(()=>[t(I,{class:"text-h6 font-weight-bold primary-text"},{default:n(()=>[i[20]||(i[20]=_(" 订单数据详情 ")),t(D),t(K,{modelValue:d.search,"onUpdate:modelValue":i[2]||(i[2]=m=>d.search=m),label:"搜索","prepend-inner-icon":"mdi-magnify",variant:"outlined","hide-details":"",density:"comfortable",class:"search-field",onKeyup:Ft(d.handleSearch,["enter"])},null,8,["modelValue","onKeyup"])]),_:1}),t(R,{"items-per-page":d.itemsPerPage,"onUpdate:itemsPerPage":i[3]||(i[3]=m=>d.itemsPerPage=m),headers:d.headers,items:d.filteredOrders,search:d.search,class:"elevation-1 mt-2","item-value":"order_id"},{"item.priority":n(({item:m})=>[t(j,{color:d.getPriorityColor(m.priority),"text-color":d.getPriorityTextColor(m.priority),size:"small"},{default:n(()=>[_(P(d.getPriorityLabel(m.priority)),1)]),_:2},1032,["color","text-color"])]),"item.product_type":n(({item:m})=>[t(j,{color:d.getCategoryColor(m.product_type),size:"small",variant:"tonal"},{default:n(()=>[_(P(m.product_type),1)]),_:2},1032,["color"])]),"item.order_quantity":n(({item:m})=>[t(F,{"model-value":m.order_quantity,color:d.getQuantityColor(m.order_quantity),height:"8",rounded:"",class:"mt-2 mb-2"},null,8,["model-value","color"]),A("span",te,P(m.order_quantity),1)]),_:1},8,["items-per-page","headers","items","search"])]),_:1})]),_:1})]),_:1}),t(X,{modelValue:d.filterDialog,"onUpdate:modelValue":i[7]||(i[7]=m=>d.filterDialog=m),"max-width":"600"},{default:n(()=>[t(w,null,{default:n(()=>[t(I,{class:"text-h6"},{default:n(()=>i[21]||(i[21]=[_("高级筛选")])),_:1}),t(k,null,{default:n(()=>[t(z,null,{default:n(()=>[t(S,{cols:"12",sm:"6"},{default:n(()=>[t(W,{modelValue:d.filters.productTypes,"onUpdate:modelValue":i[4]||(i[4]=m=>d.filters.productTypes=m),items:d.availableProductTypes,label:"产品类型",multiple:"",chips:"",variant:"outlined"},null,8,["modelValue","items"])]),_:1}),t(S,{cols:"12",sm:"6"},{default:n(()=>[t(G,{modelValue:d.filters.priorityRange,"onUpdate:modelValue":i[5]||(i[5]=m=>d.filters.priorityRange=m),label:"优先级范围",min:"1",max:"10",step:"1","thumb-label":"always"},null,8,["modelValue"])]),_:1}),t(S,{cols:"12"},{default:n(()=>[t(G,{modelValue:d.filters.quantityRange,"onUpdate:modelValue":i[6]||(i[6]=m=>d.filters.quantityRange=m),label:"数量范围",min:"0",max:"100",step:"1","thumb-label":"always"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),t(it,null,{default:n(()=>[t(D),t(q,{color:"primary",variant:"text",onClick:d.resetFilters},{default:n(()=>i[22]||(i[22]=[_("重置")])),_:1},8,["onClick"]),t(q,{color:"primary",onClick:d.applyFilters},{default:n(()=>i[23]||(i[23]=[_("应用")])),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),t(X,{modelValue:d.insightsDialog,"onUpdate:modelValue":i[9]||(i[9]=m=>d.insightsDialog=m),fullscreen:""},{default:n(()=>[t(w,null,{default:n(()=>[t(ct,{color:"primary"},{default:n(()=>[t(q,{icon:"",onClick:i[8]||(i[8]=m=>d.insightsDialog=!1)},{default:n(()=>[t(E,null,{default:n(()=>i[24]||(i[24]=[_("mdi-close")])),_:1})]),_:1}),t(dt,null,{default:n(()=>i[25]||(i[25]=[_("数据洞察")])),_:1}),t(D),t(q,{icon:"",onClick:d.exportInsights},{default:n(()=>[t(E,null,{default:n(()=>i[26]||(i[26]=[_("mdi-export")])),_:1})]),_:1},8,["onClick"])]),_:1}),t(k,null,{default:n(()=>[t(z,null,{default:n(()=>[t(S,{cols:"12",md:"6"},{default:n(()=>[t(w,{class:"mb-4"},{default:n(()=>[t(I,{class:"text-subtitle-1"},{default:n(()=>i[27]||(i[27]=[_("关键见解")])),_:1}),t(k,null,{default:n(()=>[t(ot,{lines:"two"},{default:n(()=>[(T(!0),yt(mt,null,ht(d.keyInsights,(m,V)=>(T(),H(et,{key:V},{prepend:n(()=>[t(E,{color:m.color,icon:m.icon},null,8,["color","icon"])]),default:n(()=>[t(Y,null,{default:n(()=>[_(P(m.title),1)]),_:2},1024),t(tt,null,{default:n(()=>[_(P(m.description),1)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1})]),_:1}),t(S,{cols:"12",md:"6"},{default:n(()=>[t(w,null,{default:n(()=>[t(I,{class:"text-subtitle-1"},{default:n(()=>i[28]||(i[28]=[_("异常检测")])),_:1}),t(k,null,{default:n(()=>[A("div",ee,null,512),d.anomalies.length>0?(T(),H(ut,{key:0,color:"warning",variant:"tonal",class:"mt-4"},{default:n(()=>[A("div",oe,"检测到 "+P(d.anomalies.length)+" 个潜在异常",1),t(ot,{density:"compact"},{default:n(()=>[(T(!0),yt(mt,null,ht(d.anomalies,(m,V)=>(T(),H(et,{key:V},{default:n(()=>[t(Y,null,{default:n(()=>[_(P(m.description),1)]),_:2},1024),t(tt,null,{default:n(()=>[_("订单 #"+P(m.order_id),1)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})):Rt("",!0)]),_:1})]),_:1})]),_:1})]),_:1}),t(z,{class:"mt-4"},{default:n(()=>[t(S,{cols:"12"},{default:n(()=>[t(w,null,{default:n(()=>[t(I,{class:"text-subtitle-1"},{default:n(()=>i[29]||(i[29]=[_("预测分析")])),_:1}),t(k,null,{default:n(()=>[A("div",ne,null,512)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})}const pe=Lt(Ut,[["render",ae],["__scopeId","data-v-d5eeafd9"]]);export{pe as default};
